function setupNavbar(){const e=document.getElementById("menuBtn"),t=document.getElementById("navLinks"),n=Array.from(document.querySelectorAll(".dropdown"));e&&t&&e.addEventListener("click",()=>{t.classList.toggle("open")}),t&&t.addEventListener("click",s=>{s.target.closest("a")&&t.classList.contains("open")&&t.classList.remove("open")}),(()=>{const s=t&&(t.querySelector('input[type="search"]')||t.querySelector(".search-bar input"));s&&s.addEventListener("focus",()=>{setTimeout(()=>{try{s.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},300)})})(),e&&t&&document.addEventListener("click",s=>{if(!t.classList.contains("open"))return;const a=s.target;a instanceof Node&&(t.contains(a)||e.contains(a)||(t.classList.remove("open"),n.forEach(i=>i.classList.remove("open"))))}),n.forEach(s=>{const a=s.querySelector(".dropbtn");a&&a.addEventListener("click",i=>{const g=String(a?.tagName||"").toUpperCase()==="A"&&!!a.getAttribute("href"),r=!!i.target?.closest?.(".caret-toggle");g&&!r||(i.preventDefault(),s.classList.toggle("open"))})})}function decoratePromoTagline(){const e=document.querySelector(".promo-strip [data-i18n='brand.tagline']");if(!e||e.parentElement?.querySelector?.(".promo-bolt"))return;const t=document.createElement("span");t.className="promo-bolt",t.setAttribute("aria-hidden","true"),t.textContent=" \u26A1",e.insertAdjacentElement("afterend",t)}function setupFadeIn(){const e=document.querySelectorAll(".fade-in");if(!e.length)return;if(typeof IntersectionObserver>"u"){e.forEach(s=>{s.classList.add("show"),s.removeAttribute("data-fade")});return}const t=new IntersectionObserver(s=>{s.forEach(a=>{a.isIntersecting&&a.target.classList.add("show")})},{threshold:.12}),n=Math.max(1,window.innerHeight||1);e.forEach(s=>{if(s.getBoundingClientRect().top<n*.95){s.classList.add("show"),s.removeAttribute("data-fade");return}s.setAttribute("data-fade","1"),t.observe(s)})}function setupStickyHeader(){const e=document.querySelector(".site-header");if(!e)return;const t=document.getElementById("navLinks");let n=!1,s=Math.max(0,window.scrollY||0);const a=()=>{n||(n=!0,requestAnimationFrame(()=>{const i=Math.max(0,window.scrollY||0);if(e.classList.toggle("scrolled",i>8),t?.classList?.contains("open")){e.classList.remove("promo-collapsed"),s=i,n=!1;return}i<=12?e.classList.remove("promo-collapsed"):i>s+2?e.classList.add("promo-collapsed"):i<s-2&&e.classList.remove("promo-collapsed"),s=i,n=!1}))};window.addEventListener("scroll",a,{passive:!0}),a()}function optimizeImageElement(e){if(!(e instanceof HTMLImageElement)||e.dataset.ppsImgOptimized==="1")return;const t=String(e.getAttribute("src")||"").trim();if(!t||t.startsWith("data:")||t.startsWith("blob:"))return;const n=t.split("?")[0].toLowerCase(),s=n.endsWith(".svg"),a=/\.(png|jpe?g|webp|avif)$/i.test(n);e.getAttribute("decoding")||e.setAttribute("decoding","async");const i=!!e.closest(".site-header"),g=!!e.closest(".hero-carousel"),r=e.getBoundingClientRect(),o=Math.max(1,window.innerHeight||1),l=r.top<=o*1.15,p=!i&&!g&&!l;if(e.hasAttribute("loading")||e.setAttribute("loading",p?"lazy":"eager"),e.hasAttribute("fetchpriority")||e.setAttribute("fetchpriority",p?"low":"auto"),a&&!s&&!e.hasAttribute("sizes")){const h=e.closest(".product-card, .related-products, .featured-products, .carousel-track, .product-gallery-thumbs")?"(max-width: 600px) 92vw, (max-width: 1024px) 48vw, 320px":"(max-width: 600px) 100vw, (max-width: 1024px) 60vw, 720px";e.setAttribute("sizes",h)}a&&!s&&!e.hasAttribute("srcset")&&e.setAttribute("srcset",`${t} 480w, ${t} 768w, ${t} 1024w`),e.dataset.ppsImgOptimized="1"}function optimizeImages(e){(e&&e.querySelectorAll?e:document).querySelectorAll("img").forEach(optimizeImageElement)}function setupImageOptimization(){if(optimizeImages(document),typeof MutationObserver>"u")return;new MutationObserver(t=>{t.forEach(n=>{n.addedNodes.forEach(s=>{if(s instanceof Element){if(s.tagName==="IMG"){optimizeImageElement(s);return}s.querySelectorAll&&optimizeImages(s)}})})}).observe(document.body,{childList:!0,subtree:!0})}function syncAccountLink(){const e=document.querySelector('a[href="./login.html"]');if(!e||!window.PPS?.getSession)return;const t=window.PPS.getSession();if(!t)return;e.href="./account.html";const n=e.querySelector(".nav-icon"),s=e.querySelector("span:not(.nav-icon)"),a=String(t.name||"").trim().split(/\s+/)[0]||"",i=window.PPS_I18N?.t("nav.greeting")||"Hi, {{name}}",g=a?i.replace("{{name}}",a):window.PPS_I18N?.t("nav.my_account")||"My Account";s?s.textContent=g:n&&n.nextSibling?n.nextSibling.nodeValue=g:e.textContent=g}function getNavTools(e){let t=e.querySelector(".nav-tools");return t||(t=document.createElement("div"),t.className="nav-tools",e.appendChild(t)),t}function injectLangSwitcher(){const e=document.getElementById("navLinks");if(!e||e.querySelector(".lang-switcher"))return;const t=getNavTools(e),n=(document.documentElement?.dataset?.langOptions||"en,fr,es,ko,hi,ta,zh").split(",").map(g=>g.trim()).filter(Boolean),s={en:"English",fr:"French",es:"Spanish",ko:"Korean",hi:"Hindi",ta:"Tamil",zh:"Mandarin"},a=document.createElement("div");a.className="lang-switcher",a.innerHTML=`
    <select id="langSelect" class="lang-select" aria-label="Language">
      ${n.map(g=>`<option value="${g}">${s[g]||g}</option>`).join("")}
    </select>
  `,t.appendChild(a);const i=a.querySelector("#langSelect");if(i){const g=window.PPS_I18N?.getLang?.()||"en";i.value=g,i.addEventListener("change",r=>{window.PPS_I18N?.setLang?.(r.target.value)})}}function shouldPromptForLanguage(){try{if(new URLSearchParams(window.location.search).get("lang"))return!1}catch{}try{if(localStorage.getItem("pps_lang")||localStorage.getItem("pps_lang_prompt_dismissed"))return!1}catch{}return!(document.cookie&&document.cookie.includes("pps_lang="))}function showLanguageModal(){if(document.getElementById("ppsLangModal"))return;const t=document.createElement("div");t.className="pps-modal-overlay",t.id="ppsLangModal",t.innerHTML=`
    <div class="pps-modal" role="dialog" aria-modal="true" aria-labelledby="ppsLangTitle">
      <div class="pps-modal-header">
        <div>
          <h2 class="pps-modal-title" id="ppsLangTitle">${window.PPS_I18N?.t("lang.prompt.title")||"Choose your language"}</h2>
          <p class="pps-modal-subtitle">${window.PPS_I18N?.t("lang.prompt.subtitle")||"Select the language that\u2019s easiest for you. You can change it anytime from the top menu."}</p>
        </div>
        <button class="pps-modal-close" type="button" aria-label="${window.PPS_I18N?.t("lang.prompt.close")||"Close"}">\xD7</button>
      </div>
      <div class="pps-modal-body">
        <div class="pps-modal-row">
          <select class="input" id="ppsLangModalSelect" aria-label="${window.PPS_I18N?.t("lang.label")||"Language"}" style="flex:1; min-width:220px;">
            <option value="en">English</option>
            <option value="fr">French</option>
            <option value="es">Spanish</option>
            <option value="ko">Korean</option>
            <option value="hi">Hindi</option>
            <option value="ta">Tamil</option>
            <option value="zh">Mandarin</option>
          </select>
        </div>
        <div class="pps-modal-actions">
          <button class="btn btn-outline" type="button" id="ppsLangModalLater">${window.PPS_I18N?.t("lang.prompt.later")||"Not now"}</button>
          <button class="btn btn-primary" type="button" id="ppsLangModalContinue">${window.PPS_I18N?.t("lang.prompt.continue")||"Continue"}</button>
        </div>
      </div>
    </div>
  `,document.body.appendChild(t);const n=()=>{try{localStorage.setItem("pps_lang_prompt_dismissed","1")}catch{}t.classList.remove("open"),setTimeout(()=>t.remove(),180)},s=t.querySelector(".pps-modal"),a=t.querySelector(".pps-modal-close"),i=t.querySelector("#ppsLangModalLater"),g=t.querySelector("#ppsLangModalContinue"),r=t.querySelector("#ppsLangModalSelect"),o=window.PPS_I18N?.getLang?.()||"en";r&&(r.value=o),t.addEventListener("click",l=>{l.target instanceof Node&&(s&&s.contains(l.target)||n())}),a?.addEventListener("click",n),i?.addEventListener("click",n),g?.addEventListener("click",()=>{const l=String(r?.value||"").trim().toLowerCase(),h=new Set(["en","fr","es","ko","hi","ta","zh"]).has(l)?l:"en";try{localStorage.setItem("pps_lang_prompt_dismissed","1")}catch{}try{if(window.PPS_I18N?.setLang)window.PPS_I18N.setLang(h);else{try{localStorage.setItem("pps_lang",h)}catch{}try{document.cookie=`pps_lang=${encodeURIComponent(h)}; max-age=${3600*24*365}; path=/; samesite=lax`}catch{}try{const S=new URL(window.location.href);S.searchParams.set("lang",h),window.history.replaceState({},"",S.toString())}catch{}document.documentElement.lang=h}}catch{}n()}),t.classList.add("open"),setTimeout(()=>r?.focus?.(),50)}function scheduleLanguagePrompt(){shouldPromptForLanguage()&&setTimeout(()=>{shouldPromptForLanguage()&&showLanguageModal()},2500)}function injectCurrencySwitcher(){const e=document.getElementById("navLinks");if(!e||!window.PPS?.getCurrency||e.querySelector(".currency-switcher"))return;const t=getNavTools(e),n=document.createElement("div");n.className="currency-switcher",n.innerHTML=`
    <span class="currency-symbol" aria-hidden="true">$</span>
    <select id="currencySelect" class="currency-select" aria-label="Currency">
      <option value="CAD">CAD</option>
      <option value="USD">USD</option>
    </select>
  `,t.appendChild(n);const s=n.querySelector("#currencySelect");s&&(s.value=window.PPS.getCurrency(),s.addEventListener("change",a=>{window.PPS.setCurrency(a.target.value)}))}function injectResourcesDropdown(){const e=document.getElementById("navLinks");if(!e||e.querySelector(".dropdown.resources-dropdown"))return;e.querySelector(".dropdown.industry-dropdown")?.remove?.(),e.querySelector('a[href="./industries.html"]')?.remove?.(),e.querySelector('a[href="./industry-commercial-laundry.html"]')?.remove?.(),e.querySelector('a[href="./industry-healthcare.html"]')?.remove?.(),e.querySelector('a[href="./blog.html"]')?.remove?.();const t=e.querySelector('a[href="./resources.html"]'),n=document.createElement("div");if(n.className="dropdown resources-dropdown",n.innerHTML=`
    <a class="dropbtn" href="./resources.html"><span data-i18n="nav.resources">Resources</span> <span class="caret caret-toggle" aria-hidden="true"></span></a>
    <div class="dropdown-menu">
      <a href="./resources.html" data-i18n="nav.resources.guides">Guides</a>
      <a href="./industries.html" data-i18n="nav.industry.overview">Industries</a>
      <a href="./industry-commercial-laundry.html" data-i18n="nav.industry.laundry">Commercial laundry</a>
      <a href="./industry-healthcare.html" data-i18n="nav.industry.healthcare">Healthcare</a>
      <a href="./blog.html" data-i18n="nav.industry.blog">Blog</a>
    </div>
  `,t&&t.parentElement===e)t.replaceWith(n);else{const s=e.querySelector('a[href="./specials.html"]');s&&s.parentElement===e?s.insertAdjacentElement("afterend",n):e.appendChild(n)}try{window.PPS_I18N?.applyTranslations?.()}catch{}}function injectAboutDropdown(){const e=document.getElementById("navLinks");if(!e||e.querySelector(".dropdown.about-dropdown"))return;const t=e.querySelector('a[href="./about.html"]');if(!t)return;const n=document.createElement("div");n.className="dropdown about-dropdown",n.innerHTML=`
    <a class="dropbtn" href="./about.html"><span data-i18n="nav.about">About Us</span> <span class="caret caret-toggle" aria-hidden="true"></span></a>
    <div class="dropdown-menu">
      <a href="./about.html" data-i18n="nav.about_overview">About Power Poly Supplies</a>
      <a href="./about.html#why" data-i18n="nav.about_why">Why Power Poly</a>
      <a href="./about.html#sectors" data-i18n="nav.about_sectors">Sectors we serve</a>
      <a href="./about.html#quality" data-i18n="nav.about_quality">Quality promise</a>
    </div>
  `,t.replaceWith(n);try{window.PPS_I18N?.applyTranslations?.()}catch{}}function getNotifUnreadCount(){try{const e=window.PPS?.getSession?.(),t=String(e?.email||"").trim().toLowerCase();if(!t)return 0;const n=`pps_account_${t}_notifications_v1`,s=localStorage.getItem(n),a=s?JSON.parse(s):[];return Array.isArray(a)?a.reduce((i,g)=>i+(g?.readAt?0:1),0):0}catch{return 0}}try{decoratePromoTagline()}catch{}function updateNotifBadges(){const e=getNotifUnreadCount();document.querySelectorAll("[data-notif-badge]").forEach(t=>{t.textContent=String(e),t.style.display=e?"":"none"})}function injectNotificationsBell(){const e=document.getElementById("navLinks");if(!e||!window.PPS?.getSession||e.querySelector(".notif-bell")||!window.PPS.getSession())return;const n=getNavTools(e),s=document.createElement("a");s.className="notif-bell",s.href="./account.html#notifications",s.setAttribute("aria-label","Notifications"),s.innerHTML=`
    <span class="nav-icon bell-icon" aria-hidden="true"></span>
    <span class="badge" data-notif-badge style="display:none;">0</span>
  `,n.appendChild(s),updateNotifBadges(),window.addEventListener("storage",a=>{String(a?.key||"").includes("_notifications_v1")&&updateNotifBadges()}),window.addEventListener("pps:notifs",updateNotifBadges)}function injectMiniCartPreview(){const e=document.querySelector('a[href="./cart.html"]');if(!e||e.dataset.miniCartReady)return;e.dataset.miniCartReady="1",e.classList.add("mini-cart-anchor");const t=document.createElement("div");t.className="mini-cart-popover",t.innerHTML=`
    <div class="mini-cart-head">
      <strong>Cart preview</strong>
      <a href="./cart.html">View cart</a>
    </div>
    <div class="mini-cart-body" id="miniCartBody"></div>
  `,e.appendChild(t);let n=0;const s=()=>{clearTimeout(n),t.classList.add("open"),i()},a=()=>{clearTimeout(n),n=setTimeout(()=>t.classList.remove("open"),140)};e.addEventListener("mouseenter",s),e.addEventListener("mouseleave",a),t.addEventListener("mouseenter",s),t.addEventListener("mouseleave",a);async function i(){const g=document.getElementById("miniCartBody");if(!g||!window.PPS?.loadProducts)return;const r=PPS.getCart?.()||[];let o=[];try{o=await PPS.loadProducts()}catch{o=[]}if(!r.length){g.innerHTML='<div class="mini-cart-empty">Your cart is empty.</div>';return}const l=r.slice(0,4).map(p=>{const h=o.find(S=>S.id===p.id);return{name:h?.name||p.name||"Item",image:h?.image||"./assets/poly%20logo%20without%20background.png",qty:p.qty}});g.innerHTML=`
      <div class="mini-cart-items">
        ${l.map(p=>`
          <div class="mini-cart-item">
            <img src="${p.image}" alt="">
            <div>
              <div class="mini-cart-name">${p.name}</div>
              <div class="mini-cart-qty">Qty: ${p.qty}</div>
            </div>
          </div>
        `).join("")}
      </div>
      <div class="mini-cart-actions">
        <a class="btn btn-primary btn-sm" href="./checkout.html">Checkout</a>
        <a class="btn btn-outline btn-sm" href="./products.html">Continue shopping</a>
      </div>
    `}window.addEventListener("pps:cart",i)}function injectCartSidebar(){if(document.getElementById("cartSidebar"))return;const e=document.createElement("aside");e.className="cart-sidebar",e.id="cartSidebar",e.innerHTML=`
    <div class="cart-sidebar-card">
      <div class="cart-sidebar-title">Saved for later</div>
      <div class="cart-sidebar-list" id="cartSidebarSaved"></div>
      <a class="btn btn-outline btn-sm" href="./account.html#wishlists">Manage saved items</a>
    </div>
  `,document.body.appendChild(e);async function t(){const n=document.getElementById("cartSidebarSaved");if(!n||!window.PPS?.loadProducts)return;if(!PPS.getSession?.()){n.innerHTML='<div class="cart-sidebar-empty">Sign in to see saved items.</div>';return}let a=[];try{a=await PPS.loadProducts()}catch{a=[]}const r=(PPS.getWishlists?.()?.lists?.[0]?.items?.map(o=>o.productId)||[]).map(o=>a.find(l=>l.id===o)).filter(Boolean).slice(0,3);if(!r.length){n.innerHTML='<div class="cart-sidebar-empty">Save items to build your list.</div>';return}n.innerHTML=r.map(o=>`
      <a class="cart-sidebar-item" href="./product.html?slug=${encodeURIComponent(o.slug)}">
        <img src="${o.image}" alt="${o.name}" loading="lazy" decoding="async">
        <span>${o.name}</span>
      </a>
    `).join("")}t(),window.addEventListener("pps:wishlists",t)}function injectFooter(){const e=document.querySelector(".footer");if(!e)return;const t=new Date().getFullYear(),n=document.createElement("footer");n.className="footer dark-footer",n.innerHTML=`
      <div class="footer-inner">
        <div class="footer-brand">
          <span data-i18n="brand.name">Power Poly Supplies</span>
          <span style="color:#ffb25c; font-size:12px;" data-i18n="brand.tagline">Power your packaging</span>
          <div class="footer-meta" data-i18n="footer.meta">Bulk stock | Fast shipping | Canada-wide</div>
          <div class="footer-essential">
            <a href="tel:+16475238645">647-523-8645</a>
            <span>|</span>
            <a href="mailto:powerpolysupplies@gmail.com">powerpolysupplies@gmail.com</a>
          </div>
        </div>
        <details class="footer-section footer-section-shop" open>
          <summary>
            <h4 data-i18n="footer.shop">Shop</h4>
            <span class="footer-caret" aria-hidden="true"></span>
          </summary>
          <ul>
            <li><a href="./products.html" data-i18n="footer.all_products">All products</a></li>
            <li><a href="./specials.html" data-i18n="footer.special_offers">Special offers</a></li>
            <li><a href="./about.html" data-i18n="footer.about">About us</a></li>
            <li><a href="./contact.html" data-i18n="footer.contact">Contact</a></li>
            <li><a href="./feedback.html" data-i18n="footer.feedback">Feedback</a></li>
          </ul>
        </details>
        <details class="footer-section footer-section-support" open>
          <summary>
            <h4 data-i18n="footer.support">Support</h4>
            <span class="footer-caret" aria-hidden="true"></span>
          </summary>
          <div data-i18n="footer.help_line">Help line:</div>
          <div class="footer-contact-row">
            <span class="footer-inline-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M6.6 2.9c.6-.6 1.6-.7 2.3-.2l3 2a1.8 1.8 0 0 1 .6 2.3l-1.1 2.2a1 1 0 0 0 .2 1.2l2.8 2.8a1 1 0 0 0 1.2.2l2.2-1.1a1.8 1.8 0 0 1 2.3.6l2 3a1.8 1.8 0 0 1-.2 2.3l-1.3 1.3c-.8.8-2 1.2-3.1 1-3.1-.5-6.2-2.2-9.1-5.1S2.3 9.7 1.8 6.6c-.2-1.1.2-2.3 1-3.1z"/></svg>
            </span>
            Angel <a href="tel:+16475238645">647-523-8645</a>
          </div>
          <div class="footer-contact-row">
            <span class="footer-inline-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M6.6 2.9c.6-.6 1.6-.7 2.3-.2l3 2a1.8 1.8 0 0 1 .6 2.3l-1.1 2.2a1 1 0 0 0 .2 1.2l2.8 2.8a1 1 0 0 0 1.2.2l2.2-1.1a1.8 1.8 0 0 1 2.3.6l2 3a1.8 1.8 0 0 1-.2 2.3l-1.3 1.3c-.8.8-2 1.2-3.1 1-3.1-.5-6.2-2.2-9.1-5.1S2.3 9.7 1.8 6.6c-.2-1.1.2-2.3 1-3.1z"/></svg>
            </span>
            Andrew <a href="tel:+14374256638">437-425-6638</a>
          </div>
          <div class="footer-contact-row">
            <span class="footer-inline-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M6.6 2.9c.6-.6 1.6-.7 2.3-.2l3 2a1.8 1.8 0 0 1 .6 2.3l-1.1 2.2a1 1 0 0 0 .2 1.2l2.8 2.8a1 1 0 0 0 1.2.2l2.2-1.1a1.8 1.8 0 0 1 2.3.6l2 3a1.8 1.8 0 0 1-.2 2.3l-1.3 1.3c-.8.8-2 1.2-3.1 1-3.1-.5-6.2-2.2-9.1-5.1S2.3 9.7 1.8 6.6c-.2-1.1.2-2.3 1-3.1z"/></svg>
            </span>
            Achchu <a href="tel:+16475704878">647-570-4878</a>
          </div>
          <div class="footer-contact-row">
            <span class="footer-inline-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 2.2V17h16V8.2l-7.6 4.53a1.5 1.5 0 0 1-1.54 0zM19.2 7H4.8l7.2 4.28z"/></svg>
            </span>
            <span data-i18n="footer.email">Email:</span> <a href="mailto:powerpolysupplies@gmail.com">powerpolysupplies@gmail.com</a>
          </div>
          <div class="footer-contact-row footer-address">
            <span class="footer-inline-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 5.25-7 13-7 13S5 14.25 5 9a7 7 0 0 1 7-7zm0 4a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/></svg>
            </span>
            <span data-i18n="footer.address">Address:</span> 15725 Weston Rd, Kettleby, ON L7B 0L4
          </div>
        </details>
        <details class="footer-section footer-section-connect" open>
          <summary>
            <h4 data-i18n="footer.connect">Connect</h4>
            <span class="footer-caret" aria-hidden="true"></span>
          </summary>
          <div class="footer-social">
            <a class="footer-icon" aria-label="Instagram" href="https://www.instagram.com/powerpolysupplies/" title="Instagram" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24"><path d="M7 3h10a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4zm10 2H7a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm-5 3.5A4.5 4.5 0 1 1 7.5 13 4.5 4.5 0 0 1 12 8.5zm0 2A2.5 2.5 0 1 0 14.5 13 2.5 2.5 0 0 0 12 10.5zm4.75-4.25a1 1 0 1 1-1 1 1 1 0 0 1 1-1z"/></svg>
            </a>
            <a class="footer-icon" aria-label="Facebook" href="#" title="Facebook">
              <svg viewBox="0 0 24 24"><path d="M13 10.5V8.75c0-.66.44-1 .98-1H15V5h-2c-2 0-3 1.4-3 3.1V10.5H8v2.5h2v6h3v-6h2.1l.4-2.5H13z"/></svg>
            </a>
            <a class="footer-icon" aria-label="Email" href="mailto:powerpolysupplies@gmail.com" title="Email">
              <svg viewBox="0 0 24 24"><path d="M4 6h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm0 2.2V17h16V8.2l-7.6 4.53a1.5 1.5 0 0 1-1.54 0zM19.2 7H4.8l7.2 4.28z"/></svg>
            </a>
            <a class="footer-icon" aria-label="Threads" href="https://www.threads.com/@powerpolysupplies?xmt=AQF0fdKod0xz4ngLncLsvNOIzYM0YhviIUzqV5AnbhzgHkA" title="Threads" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24"><path d="M12.06 2c-5.05 0-9.06 4.01-9.06 9.06s4.01 9.06 9.06 9.06 9.06-4.01 9.06-9.06S17.11 2 12.06 2zm4.27 11.03c-.1-.04-.2-.08-.3-.12-.23 1.1-.72 1.89-1.47 2.35-.9.55-1.96.57-2.54.48-.88-.15-1.62-.7-1.99-1.47-.24-.51-.36-1.12-.36-1.82 0-.16.01-.33.03-.5.82.75 1.93 1.1 2.97.93 1.22-.2 2.2-1.15 2.43-2.38.28-1.41-.48-2.8-1.91-3.33-.82-.31-1.69-.32-2.64-.32h-.07c-.34 0-.69.01-1.05.01l-.13.01V6.6c.27-.02.55-.03.83-.04.35-.01.71-.02 1.06-.02 1.16 0 2.36.01 3.36.39 1.84.69 2.9 2.39 2.52 4.33-.06.32-.15.63-.26.94zm-2.39-2.11c-.12.6-.62 1.08-1.22 1.18-.63.11-1.3-.2-1.63-.76l-.2-.35-.05.4c-.08.63-.1 1.62.31 2.5.24.51.61.8 1.15.89.52.08 1.17 0 1.57-.25.49-.3.82-.93.94-1.78l.04-.26-.25-.1c-.21-.08-.42-.16-.63-.25l-.03-.01z"/></svg>
            </a>
            <a class="footer-icon" aria-label="WhatsApp" href="https://chat.whatsapp.com/LVaouedAZVIEcgrD6nj2hC" title="WhatsApp" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24"><path d="M12.04 2a9.94 9.94 0 0 0-8.52 15.05L2 22l5.1-1.33A9.95 9.95 0 1 0 12.04 2zm5.78 14.4c-.24.68-1.38 1.31-1.9 1.38-.5.07-1.14.1-1.84-.11-.42-.14-.95-.3-1.64-.6-2.9-1.26-4.78-4.16-4.92-4.36-.14-.2-1.18-1.57-1.18-3 0-1.43.75-2.13 1.01-2.42.25-.28.56-.35.74-.35h.53c.17 0 .4-.06.62.47.24.56.8 1.94.87 2.08.07.14.12.3.02.48-.1.18-.16.3-.31.46-.16.16-.33.35-.47.47-.16.16-.34.34-.15.65.2.31.9 1.47 1.93 2.38 1.33 1.17 2.44 1.53 2.8 1.7.36.17.57.14.78-.09.21-.23.9-1.05 1.14-1.41.24-.36.48-.3.8-.18.33.12 2.08.98 2.44 1.16.36.18.6.27.69.42.09.15.09.87-.15 1.55z"/></svg>
            </a>
          </div>
        </details>
        <details class="footer-section footer-section-legal" open>
          <summary>
            <h4 data-i18n="footer.legal">Legal</h4>
            <span class="footer-caret" aria-hidden="true"></span>
          </summary>
          <ul>
            <li><a href="./legal-shipping.html" data-i18n="footer.shipping">Shipping & Returns</a></li>
            <li><a href="./legal-privacy.html" data-i18n="footer.privacy">Privacy Policy</a></li>
            <li><a href="./legal-terms.html" data-i18n="footer.terms">Terms & Conditions</a></li>
          </ul>
        </details>
        <div class="footer-recent">
          <div class="footer-recent-title">Recently viewed</div>
          <div class="footer-recent-grid" id="footerRecentGrid"></div>
        </div>
        <div class="footer-bottom">
          <span data-i18n="footer.rights">(C) {{year}} Power Poly Supplies. All rights reserved.</span>
          <span class="footer-trust">
            <span class="guarantee-badge" title="Satisfaction guarantee">Money-back guarantee</span>
            <span class="payment-icons" aria-label="Payment methods">
              <span class="pay-badge" aria-hidden="true">VISA</span>
              <span class="pay-badge" aria-hidden="true">Mastercard</span>
              <span class="pay-badge" aria-hidden="true">Square</span>
            </span>
          </span>
        </div>
      </div>
  `,e.remove(),document.body.appendChild(n),setupFooterSections(n),window.PPS_I18N?.applyTranslations?.(),renderFooterRecentProducts(),new IntersectionObserver(a=>{a.forEach(i=>{i.isIntersecting&&n.classList.add("reveal")})},{threshold:.2}).observe(n)}function setupFooterSections(e){if(!e)return;const t=Array.from(e.querySelectorAll(".footer-section"));if(!t.length)return;const n=window.matchMedia("(max-width: 900px)"),s=()=>{t.forEach(a=>{n.matches?a.removeAttribute("open"):a.setAttribute("open","")})};s(),typeof n.addEventListener=="function"?n.addEventListener("change",s):typeof n.addListener=="function"&&n.addListener(s)}async function renderFooterRecentProducts(){const e=document.getElementById("footerRecentGrid");if(!e||!window.PPS?.loadProducts)return;let t=[];try{t=await window.PPS.loadProducts()}catch{return}let n=[];try{const a=localStorage.getItem("pps_recently_viewed_v1"),i=JSON.parse(a||"[]");n=Array.isArray(i)?i:[]}catch{n=[]}const s=n.map(a=>t.find(i=>String(i.slug)===String(a))).filter(Boolean).slice(0,window.matchMedia("(max-width: 900px)").matches?2:4);if(!s.length){e.innerHTML='<div class="footer-recent-empty">Browse products to see your recently viewed items.</div>';return}e.innerHTML=s.map(a=>`
    <a class="footer-recent-card" href="./product.html?slug=${encodeURIComponent(a.slug)}">
      <img src="${a.image}" alt="${a.name}" loading="lazy" decoding="async">
      <span>${a.name}</span>
    </a>
  `).join("");try{window.PPS_I18N?.applyTranslations?.()}catch{}}function normalizeSearchText(e){return String(e||"").toLowerCase().replace(/["'()]/g,"").replace(/[^a-z0-9]+/g," ").trim()}function setupSearch(){const e=document.querySelectorAll("form.search-bar");if(!e.length)return;const n=new URLSearchParams(window.location.search).get("q");e.forEach(r=>{const o=r.querySelector('input[type="search"]');o&&n&&!o.value&&(o.value=n)});let s=null,a=null;const i=async()=>s&&s.length?s:window.PPS?.loadProducts?(s=await window.PPS.loadProducts(),s):[],g=async()=>{if(a&&a.length)return a;const r=await i();return a=(Array.isArray(r)?r:[]).map(o=>{const l=normalizeSearchText(o?.name),p=normalizeSearchText(o?.slug),h=normalizeSearchText(o?.category);return{p:o,name:l,slug:p,category:h}}),a};e.forEach(r=>{const o=r.querySelector('input[type="search"]');if(!o)return;o.setAttribute("autocomplete","off"),o.setAttribute("autocapitalize","none"),o.setAttribute("spellcheck","false");let l=r.querySelector(".search-suggestions");l||(l=document.createElement("div"),l.className="search-suggestions",l.hidden=!0,r.appendChild(l));const p=()=>{l.hidden=!0,l.innerHTML=""};let h=-1;const S=L=>{const m=Array.from(l.querySelectorAll("button"));if(!m.length){h=-1;return}const P=m.length-1;h=Math.min(P,Math.max(0,Number(L)||0)),m.forEach((B,f)=>{B.classList.toggle("active",f===h),B.setAttribute("aria-selected",f===h?"true":"false")});try{m[h]?.scrollIntoView?.({block:"nearest"})}catch{}},C=()=>{const L=Array.from(l.querySelectorAll("button"));return!L.length||h<0||h>=L.length?null:L[h]||null},M=L=>{if(!L.length){p();return}l.innerHTML=L.map(m=>{if(m.type==="category")return`<button type="button" data-cat="${m.value}" class="suggestion suggestion-category">
            <span class="suggestion-text">
              <span class="suggestion-title">${m.label}</span>
              <span class="suggestion-meta">${window.PPS_I18N?.t("search.suggestion.category")||"Category"}</span>
            </span>
          </button>`;const P=m.image?`<img class="suggestion-thumb" src="${m.image}" alt="" loading="lazy" decoding="async" width="44" height="34">`:"",_=[m.category,m.price,m.stockLabel].filter(Boolean).join(" | ");return`<button type="button" data-slug="${m.value}" class="suggestion suggestion-product">
          ${P}
          <span class="suggestion-text">
            <span class="suggestion-title">${m.label}</span>
            <span class="suggestion-meta">${_}</span>
          </span>
        </button>`}).join(""),l.hidden=!1,h=-1},I=L=>{let m=normalizeSearchText(L);[["poly bag","polybag"],["poly bags","polybag"],["garment bag","garment"],["garment bags","garment"],["struct","strut"],["struc","strut"]].forEach(([f,c])=>{const d=new RegExp(`\\b${f}\\b`,"g");m=m.replace(d,c)});const _=m.split(" ").filter(f=>f.length>=2),B=new Set(_);return _.forEach(f=>{f.endsWith("s")&&f.length>3&&B.add(f.slice(0,-1))}),Array.from(B)};let H=0;o.addEventListener("input",()=>{clearTimeout(H),H=window.setTimeout(async()=>{const L=String(o.value||""),m=normalizeSearchText(L);if(!m){p();return}const P=await g(),_=I(L),B=b=>{const A=b.name,N=b.slug,$=b.category;if(!A&&!N&&!$)return 0;let T=0;m&&(m===A||m===N)&&(T+=18),m&&(A.startsWith(m)||N.startsWith(m))&&(T+=10),m&&(A.includes(m)||N.includes(m))&&(T+=6),m&&$.includes(m)&&(T+=4);for(const O of _)O&&((A.includes(O)||N.includes(O))&&(T+=2),$.includes(O)&&(T+=1));return T},c=P.map(b=>({x:b,score:B(b)})).filter(b=>b.score>0).sort((b,A)=>A.score-b.score).slice(0,8).map(b=>b.x.p).map(b=>({type:"product",value:b.slug,label:b.name,image:b.image,category:b.category,price:window.PPS?.money?PPS.money(PPS.getTieredPriceCents?.(b,1)??b.priceCents,b.currency):"",stockLabel:b.stock<=0?window.PPS_I18N?.t("products.stock.out")||"Out of stock":b.stock<=10?window.PPS_I18N?.t("products.stock.low")||"Almost out":window.PPS_I18N?.t("products.stock.in")||"In stock"})),d=await i(),x=Array.from(new Set((Array.isArray(d)?d:[]).map(b=>b.category).filter(Boolean))).filter(b=>normalizeSearchText(b).includes(m)).slice(0,3).map(b=>({type:"category",value:b,label:b}));M([...c,...x])},120)}),o.addEventListener("keydown",L=>{if(l.hidden)return;const m=L.key;if(m==="Escape"){p(),L.preventDefault();return}if(m==="ArrowDown"){if(!l.querySelectorAll("button").length)return;S(h<0?0:h+1),L.preventDefault();return}if(m==="ArrowUp"){if(!l.querySelectorAll("button").length)return;S(h<=0?0:h-1),L.preventDefault();return}if(m==="Enter"){const P=C();if(!P)return;L.preventDefault(),P.click()}}),o.addEventListener("focus",()=>{l.innerHTML&&(l.hidden=!1)}),o.addEventListener("blur",()=>{setTimeout(p,120)}),l.addEventListener("mousedown",L=>{const m=L.target;if(!(m instanceof HTMLElement))return;const P=m.closest("button[data-slug], button[data-cat]");if(P){if(P.matches("button[data-slug]")){const _=P.getAttribute("data-slug");_&&(window.location.href=`./product.html?slug=${encodeURIComponent(_)}`)}else if(P.matches("button[data-cat]")){const _=P.getAttribute("data-cat");_&&(window.location.href=`./products.html?cat=${encodeURIComponent(_)}`)}}}),r.addEventListener("submit",async L=>{const m=String(o.value||"").trim();if(!m)return;L.preventDefault();const P=await i();if(!P.length){window.location.href=`./products.html?q=${encodeURIComponent(m)}`;return}const _=normalizeSearchText(m),B=P.find(f=>{const c=normalizeSearchText(f.name),d=normalizeSearchText(f.slug);return _&&(_===c||_===d)});if(B){window.location.href=`./product.html?slug=${encodeURIComponent(B.slug)}`;return}window.location.href=`./products.html?q=${encodeURIComponent(m)}`})})}function setupCountUp(){const e=document.querySelectorAll("[data-count-up]");if(!e.length)return;const t=window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,n=i=>String(Math.round(i)),s=i=>{const g=i.getAttribute("data-count-up"),r=i.getAttribute("data-count-suffix")||"",o=Number(g);if(!Number.isFinite(o))return;if(t){i.textContent=n(o)+r;return}const l=performance.now(),p=900,h=0,S=C=>{const M=Math.min(1,(C-l)/p),I=1-Math.pow(1-M,3),H=h+(o-h)*I;i.textContent=n(H)+r,M<1&&requestAnimationFrame(S)};requestAnimationFrame(S)},a=new IntersectionObserver(i=>{i.forEach(g=>{if(!g.isIntersecting)return;const r=g.target;r.dataset.counted!=="1"&&(r.dataset.counted="1",s(r))})},{threshold:.35});e.forEach(i=>a.observe(i))}function injectBottomNav(){if(document.querySelector(".bottom-nav")||!window.matchMedia?.("(max-width: 860px)")?.matches)return;const t=document.createElement("nav");t.className="bottom-nav",t.setAttribute("aria-label","Quick navigation"),t.innerHTML=`
    <a class="bottom-nav-item" href="./products.html">
      <span class="bicon" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </span>
      <span data-i18n="bottom.categories">Categories</span>
    </a>
    <a class="bottom-nav-item" href="#pps-search" data-bottom-search>
      <span class="bicon" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M10.5 18a7.5 7.5 0 1 1 5.3-2.2L21 21" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M15 15l1.8 1.8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </span>
      <span data-i18n="bottom.search">Search</span>
    </a>
    <a class="bottom-nav-item" href="./cart.html">
      <span class="bicon" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M6 6h14.2l-1.2 6H8.1L7.2 6H4V4h2a1 1 0 0 1 .99.86L7.8 6h12.42a1 1 0 0 1 .98 1.2l-1.4 7a1 1 0 0 1-.98.8H8a1 1 0 0 1-.99-.87L5.8 7H4V5h1.2L6 6zm2.5 12a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm9 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z" fill="currentColor"/></svg>
      </span>
      <span data-i18n="nav.cart">Cart</span>
      <span class="bottom-badge" data-cart-badge>0</span>
    </a>
  `,document.body.appendChild(t),window.PPS?.updateCartBadge?.(),window.PPS_I18N?.applyTranslations?.()}function focusSmartSearch(){const e=window.matchMedia?.("(max-width: 860px)")?.matches,t=n=>{if(!n)return!1;try{n.scrollIntoView({behavior:"auto",block:"nearest"})}catch{}try{n.focus({preventScroll:!0}),n.select?.()}catch{}return!0},s=document.getElementById("filterSearch");if(s){const a=document.getElementById("filtersPanel"),i=document.getElementById("toggleFilters");e&&a?.classList.contains("is-collapsed")&&(()=>{try{i?.click?.()}catch{}})(),setTimeout(()=>t(s),40);return!0}if(e)return window.location.href="./products.html#pps-search",!0;const a=document.getElementById("navLinks"),i=document.querySelector(".dropdown");a&&a.classList.add("open"),i?.classList.remove("open");const g=(a?a.querySelector('form.search-bar input[type="search"]'):null)||document.querySelector('form.search-bar input[type="search"]');return!!g&&t(g)}function setupBottomNavSearch(){window.__ppsBottomNavSearchBound||(window.__ppsBottomNavSearchBound=!0,window.location.hash==="#pps-search"&&setTimeout(()=>{if(focusSmartSearch())try{history.replaceState(null,"",window.location.pathname+window.location.search)}catch{}},0),document.addEventListener("click",e=>{if(!e.target?.closest?.("a[data-bottom-search]"))return;e.preventDefault(),e.stopPropagation(),focusSmartSearch()||(window.location.href="./products.html#pps-search")}))}function setupInteractiveTools(){if(window.__ppsInteractiveToolsBound)return;window.__ppsInteractiveToolsBound=!0;const e=(f,c=0)=>{const d=Number(f);return Number.isFinite(d)?d:c},t=(f,c,d)=>Math.min(d,Math.max(c,f)),n=f=>new Intl.NumberFormat(void 0,{maximumFractionDigits:1}).format(f),s=f=>new Intl.NumberFormat(void 0).format(Math.round(f)),a=f=>new Intl.NumberFormat(void 0,{style:"currency",currency:"CAD",maximumFractionDigits:0}).format(f);document.addEventListener("click",f=>{if(!f.target?.closest?.("[data-open-help]"))return;f.preventDefault();const d=document.getElementById("helpFab"),y=document.getElementById("helpPanel");if(!d||!y)return;d.getAttribute("aria-expanded")==="true"||d.click(),setTimeout(()=>{document.getElementById("helpChatInput")?.focus?.()},0)});const i=document.getElementById("configuratorForm"),g=document.getElementById("configuratorOutput");if(i&&g){const f=()=>{const c=i.category?.value||"Garment Bags",d=i.thickness?.value||"Standard",y=n(t(e(i.width?.value,24),6,120)),x=n(t(e(i.length?.value,54),12,120)),b=i.closure?.value||"Open bottom";g.textContent=`Recommendation: ${y}" x ${x}" ${d.toLowerCase()} ${c.toLowerCase()} with ${b.toLowerCase()}.`};["input","change"].forEach(c=>i.addEventListener(c,f)),f()}const r=document.getElementById("arLaunchBtn"),o=document.getElementById("arPreview");r&&o&&r.addEventListener("click",()=>{o.classList.add("active");const f=o.querySelector(".tool-preview-title"),c=o.querySelector(".tool-preview-desc");f&&(f.textContent="AR session started"),c&&(c.textContent=window.innerWidth<768?"Move your phone around to place the bag outline.":"AR works best on mobile. Open this page on your phone to view.")});const l=document.getElementById("sizeCalcForm"),p=document.getElementById("sizeCalcOutput");if(l&&p){const f=()=>{const c=t(e(l.garmentWidth?.value,18),10,80),d=t(e(l.garmentLength?.value,40),24,90),y=n(c+6),x=n(d+8);p.textContent=`Suggested bag size: ${y}" W x ${x}" L.`};["input","change"].forEach(c=>l.addEventListener(c,f)),f()}const h=document.getElementById("usageCalcForm"),S=document.getElementById("usageCalcOutput");if(h&&S){const f=()=>{const c=t(e(h.gpd?.value,0),0,1e5),d=t(e(h.days?.value,0),0,31),y=t(e(h.buffer?.value,0),0,50),x=c*d,b=x*(1+y/100);S.textContent=`Estimated monthly usage: ${s(x)}. Order qty with buffer: ${s(b)}.`};["input","change"].forEach(c=>h.addEventListener(c,f)),f()}const C=document.getElementById("roiCalcForm"),M=document.getElementById("roiCalcOutput");if(C&&M){const f=()=>{const c=t(e(C.volume?.value,0),0,1e6),d=t(e(C.currentCost?.value,0),0,100),y=t(e(C.newCost?.value,0),0,100),x=t(e(C.minutesSaved?.value,0),0,30),b=t(e(C.hourlyRate?.value,0),0,200),A=Math.max(0,(d-y)*c),N=Math.max(0,x/60*b*c);M.textContent=`Estimated monthly savings: ${a(A)} (materials) + ${a(N)} (labor).`};["input","change"].forEach(c=>C.addEventListener(c,f)),f()}const I=document.getElementById("sampleRequestForm"),H=document.getElementById("sampleSteps"),L=document.getElementById("sampleRequestNote");I&&H&&I.addEventListener("submit",f=>{f.preventDefault(),Array.from(H.querySelectorAll(".tool-step")).forEach((d,y)=>{d.classList.toggle("done",y===0),d.classList.toggle("active",y===1)}),L&&(L.textContent="Request logged. Sample packed in 1 business day."),I.reset()});const m=document.getElementById("quoteCompareForm"),P=document.getElementById("quoteCompareOutput");if(m&&P){const f=()=>{const c=m.vendorA?.value||"Vendor A",d=m.vendorB?.value||"Vendor B",y=t(e(m.priceA?.value,0),0,1e5),x=t(e(m.priceB?.value,0),0,1e5),b=t(e(m.leadA?.value,0),0,365),A=t(e(m.leadB?.value,0),0,365),N=y===x?`${c} + ${d}`:y<x?c:d,$=b===A?`${c} + ${d}`:b<A?c:d;P.textContent=`Best price: ${N}. Fastest delivery: ${$}.`};["input","change"].forEach(c=>m.addEventListener(c,f)),f()}const _=document.getElementById("bulkEstimatorForm"),B=document.getElementById("bulkEstimatorOutput");if(_&&B){const f=()=>{const c=t(e(_.cases?.value,1),1,1e5),d=t(e(_.casePrice?.value,0),0,1e5);let y=0;c>=250?y=12:c>=100?y=8:c>=50&&(y=5);const b=c*d*(1-y/100);B.textContent=`Bulk price: ${a(b)} with ${y}% discount.`};["input","change"].forEach(c=>_.addEventListener(c,f)),f()}}function setupAnalytics(){if(window.PPS_ANALYTICS)return;const e="pps_analytics_queue",t=(()=>{const r="pps_analytics_session",o=localStorage.getItem(r);if(o)return o;const l=`sess_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return localStorage.setItem(r,l),l})(),n=()=>{try{const r=localStorage.getItem(e),o=JSON.parse(r||"[]");return Array.isArray(o)?o:[]}catch{return[]}},s=r=>{try{localStorage.setItem(e,JSON.stringify(r.slice(-500)))}catch{}},a=(r,o={})=>{const l={event:r,data:o,ts:Date.now(),path:window.location.pathname,sessionId:t},p=n();p.push(l),s(p),window.dispatchEvent(new CustomEvent("pps:analytics",{detail:l}))},i=(r,o=["A","B"])=>{const l=`pps_ab_${r}`,p=localStorage.getItem(l);if(p)return p;const h=Math.floor(Math.random()*o.length),S=o[h];return localStorage.setItem(l,S),a("ab_assign",{key:r,variant:S}),S};window.PPS_ANALYTICS={record:a,assignVariant:i,getQueue:n},a("page_view",{title:document.title}),/product\.html$/i.test(window.location.pathname)&&a("funnel_view_product"),/cart\.html$/i.test(window.location.pathname)&&a("funnel_view_cart"),/checkout\.html$/i.test(window.location.pathname)&&a("funnel_view_checkout"),document.addEventListener("click",r=>{const o=r.target,l=document.documentElement.getBoundingClientRect(),p=(r.clientX-l.left)/Math.max(1,l.width),h=(r.clientY-l.top)/Math.max(1,l.height);a("heatmap_click",{x:p,y:h,tag:o?.tagName,id:o?.id||"",cls:o?.className||""})},{passive:!0});let g=0;window.addEventListener("scroll",()=>{const r=document.documentElement,o=Math.max(1,r.scrollHeight-r.clientHeight),l=Math.min(1,Math.max(0,r.scrollTop/o));l>g+.05&&(g=l,a("scroll_depth",{depth:Math.round(g*100)}))},{passive:!0})}function setupJourneyTracking(){if(window.__ppsJourneyBound)return;window.__ppsJourneyBound=!0;const e="pps_journey_v1",t=(n,s={})=>{try{const a=localStorage.getItem(e),i=Array.isArray(JSON.parse(a||"[]"))?JSON.parse(a||"[]"):[];i.push({step:n,meta:s,ts:Date.now(),path:window.location.pathname}),localStorage.setItem(e,JSON.stringify(i.slice(-200)))}catch{}};window.addEventListener("pps:analytics",n=>{const s=n.detail;t(s.event,s.data||{})})}function injectHelpWidget(){if(document.getElementById("helpWidget"))return;const e=document.createElement("div");e.id="helpWidget",e.className="help-widget",e.innerHTML=`
    <button class="help-fab" type="button" id="helpFab" aria-expanded="false" aria-controls="helpPanel">
      <span class="help-fab-icon" aria-hidden="true">?</span>
      <span data-i18n="help.fab">Help</span>
    </button>
    <div class="help-panel" id="helpPanel" aria-hidden="true">
      <div class="help-panel-header">
        <div data-i18n="help.title">Live customer support</div>
        <button class="help-close" type="button" id="helpClose" aria-label="Close" data-i18n-aria-label="help.close">X</button>
      </div>
      <div class="help-panel-body">
        <div class="help-tabs" role="tablist" aria-label="Help options" data-i18n-aria-label="help.tabs_aria">
          <button class="help-tab active" type="button" role="tab" aria-selected="true" data-help-tab="faq" data-i18n="help.tab.quick">Quick answers</button>
          <button class="help-tab" type="button" role="tab" aria-selected="false" data-help-tab="message" data-i18n="help.tab.message">Message us</button>
        </div>

        <div class="help-tab-panels">
          <div class="help-tab-panel open" data-help-panel="faq" role="tabpanel">
            <div class="help-chat">
              <div class="help-chat-log" id="helpChatLog" aria-live="polite"></div>
              <div class="help-suggestions" id="helpChatSuggestions" aria-label="Suggested questions" data-i18n-aria-label="help.chat.suggestions_aria"></div>
              <form class="help-chat-input" id="helpChatForm">
                <input class="input" id="helpChatInput" placeholder="Ask a question (shipping, sizes, thickness...)" data-i18n-placeholder="help.chat.placeholder" autocomplete="off">
                <button class="btn btn-primary" type="submit" data-i18n="help.chat.send">Send</button>
              </form>
              <div class="help-chat-footer">
                <a class="btn btn-outline btn-sm" href="https://chat.whatsapp.com/LVaouedAZVIEcgrD6nj2hC" target="_blank" rel="noopener">WhatsApp</a>
                <a class="btn btn-outline btn-sm" href="./resources.html" data-i18n="help.link.resources">Resources</a>
                <a class="btn btn-outline btn-sm" href="./contact.html" data-i18n="help.link.contact">Contact</a>
              </div>
            </div>
          </div>

          <div class="help-tab-panel" data-help-panel="message" role="tabpanel">
            <p data-i18n="help.subtitle">We're offline right now. Leave a message and we'll get back to you.</p>
            <form id="helpForm" class="help-form">
              <label>
                <span data-i18n="help.name">Name</span>
                <input class="input" name="name" required>
              </label>
              <label>
                <span data-i18n="help.email">Email</span>
                <input class="input" type="email" name="email" required>
              </label>
              <label>
                <span data-i18n="help.message">Message</span>
                <textarea class="input" name="message" rows="4" required></textarea>
              </label>
              <button class="btn btn-primary" type="submit" data-i18n="help.send">Send message</button>
              <div class="help-status" id="helpStatus"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  `,document.body.appendChild(e),window.PPS_I18N?.applyTranslations?.();const t={fab:e.querySelector('[data-i18n="help.fab"]'),title:e.querySelector('[data-i18n="help.title"]'),subtitle:e.querySelector('[data-i18n="help.subtitle"]'),name:e.querySelector('[data-i18n="help.name"]'),email:e.querySelector('[data-i18n="help.email"]'),message:e.querySelector('[data-i18n="help.message"]'),send:e.querySelector('[data-i18n="help.send"]')};function n(u){return{ko:{fab:"\uB3C4\uC6C0",title:"\uC2E4\uC2DC\uAC04 \uACE0\uAC1D \uC9C0\uC6D0",subtitle:"\uD604\uC7AC \uC624\uD504\uB77C\uC778\uC785\uB2C8\uB2E4. \uBA54\uC2DC\uC9C0\uB97C \uB0A8\uACA8\uC8FC\uC2DC\uBA74 \uC5F0\uB77D\uB4DC\uB9AC\uACA0\uC2B5\uB2C8\uB2E4.",name:"\uC774\uB984",email:"\uC774\uBA54\uC77C",message:"\uBA54\uC2DC\uC9C0",send:"\uBA54\uC2DC\uC9C0 \uBCF4\uB0B4\uAE30",sending:"\uC81C\uCD9C \uC911...",sent:"\uAC10\uC0AC\uD569\uB2C8\uB2E4! \uACF5\uAC04 \uC5F0\uB77D\uB4DC\uB9AC\uACA0\uC2B5\uB2C8\uB2E4.",error:"\uD604\uC7AC \uBC1C\uC1A1\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694."},hi:{fab:"\u092E\u0926\u0926",title:"\u0932\u093E\u0907\u0935 \u0917\u094D\u0930\u093E\u0939\u0915 \u0938\u0939\u093E\u092F\u0924\u093E",subtitle:"\u0939\u092E \u0905\u092D\u0940 \u0911\u092B\u093C\u0932\u093E\u0907\u0928 \u0939\u0948\u0902\u0964 \u0938\u0902\u0926\u0947\u0936 \u091B\u094B\u0921\u093C\u0947\u0902, \u0939\u092E \u0938\u0902\u092A\u0930\u094D\u0915 \u0915\u0930\u0947\u0902\u0917\u0947\u0964",name:"\u0928\u093E\u092E",email:"\u0908\u092E\u0947\u0932",message:"\u0938\u0902\u0926\u0947\u0936",send:"\u0938\u0902\u0926\u0947\u0936 \u092D\u0947\u091C\u0947\u0902",sending:"\u092D\u0947\u091C \u0930\u0939\u0947 \u0939\u0948\u0902...",sent:"\u0927\u0928\u094D\u092F\u0935\u093E\u0926! \u0939\u092E \u0938\u0902\u092A\u0930\u094D\u0915 \u0915\u0930\u0947\u0902\u0917\u0947\u0964",error:"\u0905\u092D\u0940 \u092D\u0947\u091C\u0928\u0947 \u092E\u0947\u0902 \u0938\u092E\u0938\u094D\u092F\u093E \u0939\u0948\u0964 \u0915\u0943\u092A\u092F\u093E \u0926\u094B\u092C\u093E\u0930\u093E \u0915\u094B\u0936\u093F\u0936 \u0915\u0930\u0947\u0902\u0964"},ta:{fab:"\u0B89\u0BA4\u0BB5\u0BBF",title:"\u0BA8\u0BC7\u0BB0\u0B9F\u0BBF \u0BB5\u0BBE\u0B9F\u0BBF\u0B95\u0BCD\u0B95\u0BC8\u0BAF\u0BBE\u0BB3\u0BB0\u0BCD \u0B86\u0BA4\u0BB0\u0BB5\u0BC1",subtitle:"\u0BA4\u0BB1\u0BCD\u0BAA\u0BCB\u0BA4\u0BC1 \u0B86\u0BA9\u0BCD\u0BB2\u0BC8\u0BA9\u0BBF\u0BB2\u0BCD \u0B87\u0BB2\u0BCD\u0BB2\u0BC8. \u0B92\u0BB0\u0BC1 \u0B9A\u0BC6\u0BAF\u0BCD\u0BA4\u0BBF \u0BB5\u0BBF\u0B9F\u0BC1\u0B99\u0BCD\u0B95\u0BB3\u0BCD, \u0BA8\u0BBE\u0B99\u0BCD\u0B95\u0BB3\u0BCD \u0BA4\u0BCA\u0B9F\u0BB0\u0BCD\u0BAA\u0BC1 \u0B95\u0BCA\u0BB3\u0BCD\u0BB5\u0BCB\u0BAE\u0BCD.",name:"\u0BAA\u0BC6\u0BAF\u0BB0\u0BCD",email:"\u0BAE\u0BBF\u0BA9\u0BCD\u0BA9\u0B9E\u0BCD\u0B9A\u0BB2\u0BCD",message:"\u0B9A\u0BC6\u0BAF\u0BCD\u0BA4\u0BBF",send:"\u0B9A\u0BC6\u0BAF\u0BCD\u0BA4\u0BBF\u0BAF\u0BC8 \u0B85\u0BA9\u0BC1\u0BAA\u0BCD\u0BAA\u0BC1",sending:"\u0B85\u0BA9\u0BC1\u0BAA\u0BCD\u0BAA\u0BC1\u0B95\u0BBF\u0BB1\u0B9F\u0BC1...",sent:"\u0BA8\u0BA9\u0BCD\u0BB1\u0BBF! \u0BA8\u0BBE\u0B99\u0BCD\u0B95\u0BB3\u0BCD \u0BA4\u0BCA\u0B9F\u0BB0\u0BCD\u0BAA\u0BC1 \u0B95\u0BCA\u0BB3\u0BCD\u0BB5\u0BCB\u0BAE\u0BCD.",error:"\u0BA4\u0BB1\u0BCD\u0BAA\u0BCB\u0BA4\u0BC1 \u0B85\u0BA9\u0BC1\u0BAA\u0BCD\u0BAA \u0BAE\u0BC1\u0B9F\u0BBF\u0BAF\u0BB5\u0BBF\u0BB2\u0BCD\u0BB2\u0BC8. \u0BA4\u0BAF\u0BB5\u0BC1 \u0B9A\u0BC6\u0BAF\u0BCD\u0B95."},es:{fab:"Ayuda",title:"Soporte al cliente en vivo",subtitle:"Ahora mismo estamos fuera de l\xEDnea. Deja un mensaje y nos pondremos en contacto.",name:"Nombre",email:"Correo",message:"Mensaje",send:"Enviar mensaje",sending:"Enviando...",sent:"\xA1Gracias! Nos pondremos en contacto.",error:"No se pudo enviar en este momento. Int\xE9ntalo de nuevo."}}[u]||null}function s(){const u=window.PPS_I18N?.getLang?.()||"en",w=n(u);w&&(t.fab&&(t.fab.textContent=w.fab),t.title&&(t.title.textContent=w.title),t.subtitle&&(t.subtitle.textContent=w.subtitle),t.name&&(t.name.textContent=w.name),t.email&&(t.email.textContent=w.email),t.message&&(t.message.textContent=w.message),t.send&&(t.send.textContent=w.send))}s();const a=document.getElementById("helpFab"),i=document.getElementById("helpPanel"),g=document.getElementById("helpClose"),r=document.getElementById("helpForm"),o=document.getElementById("helpStatus"),l=Array.from(e.querySelectorAll("[data-help-tab]")),p=Array.from(e.querySelectorAll("[data-help-panel]")),h=document.getElementById("helpChatLog"),S=document.getElementById("helpChatSuggestions"),C=document.getElementById("helpChatForm"),M=document.getElementById("helpChatInput"),I={messages:[]},H=(()=>{if(window.PPS_AI_CHAT_ENDPOINT)return String(window.PPS_AI_CHAT_ENDPOINT);const u=window.PPS?.API_BASE||window.PPS_API_BASE||"";return u?`${u}/api/ai-chat`:""})();function L(u){const w={role:"system",content:"You are Power Poly Supplies' helpful support assistant. Answer concisely about product sizing, thickness, shipping, payments, bulk orders, and account features. If unsure, recommend contacting support."},k=I.messages.slice(-6);return[w,...k,{role:"user",content:u}]}async function m(u){if(!H)return null;const w=D();try{const k=await fetch(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:L(u),meta:{path:window.location.pathname}})}),v=await k.json().catch(()=>({}));if(!k.ok)throw new Error(v?.error||"AI request failed");const E=v.reply||v.message||v.output_text||v.text;if(!E)throw new Error("Missing reply");I.messages.push({role:"user",content:u}),I.messages.push({role:"assistant",content:E});try{w?.remove?.()}catch{}return c({role:"bot",text:String(E)}),F(),E}catch{try{w?.remove?.()}catch{}return null}}function P(u){!a||!i||(a.setAttribute("aria-expanded",u?"true":"false"),i.setAttribute("aria-hidden",u?"false":"true"),i.classList.toggle("open",u))}function _(u){const w=u==="message"?"message":"faq";l.forEach(k=>{const v=k.getAttribute("data-help-tab")===w;k.classList.toggle("active",v),k.setAttribute("aria-selected",v?"true":"false")}),p.forEach(k=>{const v=k.getAttribute("data-help-panel")===w;k.classList.toggle("open",v)})}a&&a.addEventListener("click",()=>P(!i.classList.contains("open"))),g&&g.addEventListener("click",()=>P(!1)),l.forEach(u=>{u.addEventListener("click",()=>_(u.getAttribute("data-help-tab")))});const B=u=>String(u??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;"),f=u=>{const w=String(u||"");try{return w.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9\u00C0-\u024F\u0400-\u04FF\u0900-\u097F\u0B80-\u0BFF\u1100-\u11FF\s]/g," ").replace(/\s+/g," ").trim()}catch{return w.toLowerCase().trim()}};function c({role:u,text:w,html:k}){if(!h)return;const v=document.createElement("div");v.className=`help-chat-msg ${u==="user"?"user":"bot"}`;const E=document.createElement("div");E.className="help-chat-bubble",k?E.innerHTML=k:E.textContent=String(w||""),v.appendChild(E),h.appendChild(v),h.scrollTop=h.scrollHeight}const d=(u,w="")=>window.PPS_I18N?.t?.(u)||w||"",y=u=>d(u?.titleKey,u?.title||""),x=u=>d(u?.answerKey,typeof u?.answer=="function"?u.answer():""),b=[{id:"shipping",titleKey:"help.chat.topic.shipping",title:"Shipping / delivery",keywords:["ship","shipping","deliver","delivery","gta","outside","charge","charges","cost"],followups:[{id:"shipping_fees",labelKey:"help.chat.followup.shipping_fees",label:"Do you charge outside GTA?"},{id:"shipping_time",labelKey:"help.chat.followup.shipping_time",label:"How fast is delivery?"}],match:u=>/ship|shipping|deliver|delivery|gta|outside|charge|charges|cost|pickup|courier/i.test(u),answerKey:"help.chat.answer.shipping",answer:()=>'Standard GTA delivery is free. Express and non\u2011GTA delivery charges are confirmed by our team after we review the order and address.<br><a href="./legal-shipping.html">Read Shipping & Returns</a>'},{id:"sizes",titleKey:"help.chat.topic.sizes",title:"Garment bag sizes",keywords:["size","sizing","garment bag","cover bag","length","width","measure","measurement","gusset","coat","dress","tailles","mesure","medida","talla","\uC0AC\uC774\uC988","\uCE21\uC815","\u092E\u093E\u092A","\u0906\u0915\u093E\u0930","\u0932\u0902\u092C\u093E\u0908","\u091A\u094C\u0921\u093C\u093E\u0908","\u0B85\u0BB3\u0BB5\u0BC1","\u0BA8\u0BC0\u0BB3\u0BAE\u0BCD","\u0B85\u0B95\u0BB2\u0BAE\u0BCD"],followups:[{id:"sizes_shirts",labelKey:"help.chat.followup.sizes_shirts",label:"What size for shirts?"},{id:"sizes_coats",labelKey:"help.chat.followup.sizes_coats",label:"What size for coats?"}],match:u=>/size|sizing|garment bag|cover bag|length|width|measure|gusset|coat|dress/i.test(u),answerKey:"help.chat.answer.sizes",answer:()=>'Use garment width + 4\u20136" and garment length + 4\u20138" as a quick rule. For bulky coats, consider a wider/gusseted bag.<br><a href="./resources.html#guide-garment-bag-sizes">Read the sizing guide</a>'},{id:"thickness",titleKey:"help.chat.topic.thickness",title:"Heavy vs Extra Heavy",keywords:["heavy","extra heavy","thick","thickness","mil","gauge","tear","puncture","sharp","corner","epais","epaisseur","grueso","grosor","\uB450\uAED8","\u092E\u094B\u091F\u093E\u0908","\u0BA4\u0B9F\u0BBF\u0BAE\u0BA9\u0BCD","\u0BA4\u0B9F\u0BBF\u0BAE\u0BC8"],followups:[{id:"thickness_mil",labelKey:"help.chat.followup.thickness_mil",label:"What does mil mean?"},{id:"thickness_choice",labelKey:"help.chat.followup.thickness_choice",label:"Which one should I buy?"}],match:u=>/heavy|extra heavy|thick|thickness|mil|gauge|tear|puncture|sharp|corner/i.test(u),answerKey:"help.chat.answer.thickness",answer:()=>'Choose <b>Heavy</b> for everyday packaging. Choose <b>Extra Heavy</b> for sharp corners, heavy loads, delivery routes, or fewer tears/rewraps.<br><a href="./resources.html#heavy-vs-extra-heavy">Read the thickness guide</a>'},{id:"hangers",titleKey:"help.chat.topic.hangers",title:"Hanger types + box quantity",keywords:["hanger","hangers","shirt hanger","suit hanger","dress hanger","strut","capped","caped","cape","wire","strength","shoulder","box","case","case pack","pcs","pieces","500"],followups:[{id:"hangers_box",labelKey:"help.chat.followup.hangers_box",label:"How many hangers in a box?"},{id:"hangers_choice",labelKey:"help.chat.followup.hangers_choice",label:"Which hanger for shirts vs suits?"},{id:"hangers_caped",labelKey:"help.chat.followup.hangers_caped",label:"When should I use capped/cape hangers?"}],match:u=>/hanger|hangers|shirt hanger|suit hanger|dress hanger|strut|capped|caped|cape|wire|500/i.test(u),answerKey:"help.chat.answer.hangers",answer:()=>'Most of our hanger SKUs are packed <b>500 pieces per box</b> (case pack) - check the product page for the exact pack size.<br><br><b>Quick pick:</b> <b>Shirt</b> for tops, <b>Suit</b> for jackets, <b>Strut</b> for daily all-purpose strength, and <b>Capped/Cape</b> when you want extra shoulder stability and premium presentation.<br><a href="./products.html?cat=Hangers">Browse hangers</a>'},{id:"usage",titleKey:"help.chat.topic.usage",title:"Monthly packaging usage",keywords:["month","monthly","how much","usage","estimate","planning","plan","per day","buffer","waste","consommation","mensuel","uso","mensual","\uC0AC\uC6A9\uB7C9","\uC6D4\uAC04","\u092E\u093E\u0938\u093F\u0915","\u0909\u092A\u092F\u094B\u0917","\u092E\u0939\u0940\u0928\u093E","\u0BAE\u0BBE\u0BA4","\u0BAA\u0BAF\u0BA9\u0BCD\u0BAA\u0BBE\u0B9F\u0BC1"],followups:[{id:"usage_buffer",labelKey:"help.chat.followup.usage_buffer",label:"What buffer % should I use?"},{id:"usage_quote",labelKey:"help.chat.followup.usage_quote",label:"Can you estimate for me?"}],match:u=>/month|monthly|how much|usage|estimate|planning|plan|per day/i.test(u),answerKey:"help.chat.answer.usage",answer:()=>'A simple estimate: (garments/day) \xD7 (operating days/month), then add a 5\u201312% buffer for rewraps/tears/rush orders.<br><a href="./resources.html#dry-cleaner-packaging-usage">See the planner</a>'},{id:"pay",titleKey:"help.chat.topic.pay",title:"Payment options",keywords:["pay","payment","square","card","invoice","pay later","terms","facture","paiement","pagar","pago","\uACB0\uC81C","\uCE74\uB4DC","\u092D\u0941\u0917\u0924\u093E\u0928","\u0907\u0928\u0935\u0949\u0907\u0938","\u092A\u0947\u092E\u0947\u0928\u094D\u091F","\u0BAA\u0BA3\u0BAE\u0BCD","\u0B9A\u0BC6\u0BB2\u0BC1\u0BA4\u0BCD\u0BA4"],followups:[{id:"pay_invoice",labelKey:"help.chat.followup.pay_invoice",label:"Can I pay by invoice?"},{id:"pay_square",labelKey:"help.chat.followup.pay_square",label:"Is Square secure?"}],match:u=>/pay|payment|square|card|invoice|pay later|terms/i.test(u),answerKey:"help.chat.answer.pay",answer:()=>'You can pay online with Square or place the order now and pay later after fulfillment is confirmed. Start checkout to see both options.<br><a href="./checkout.html">Go to checkout</a>'},{id:"addresses",titleKey:"help.chat.topic.addresses",title:"Saved delivery addresses",keywords:["address","addresses","multiple locations","warehouse","branch","default","saved","adresse","direccion","direcciones","\uC8FC\uC18C","\uC9C0\uC810","\u092A\u0924\u093E","\u0BAE\u0BC1\u0B95\u0BB5\u0BB0\u0BBF","\u0B95\u0BB3\u0B9E\u0BCD\u0B9A\u0BBF\u0BAF\u0BAE\u0BCD"],followups:[{id:"addresses_how",labelKey:"help.chat.followup.addresses_how",label:"How do I add an address?"},{id:"addresses_default",labelKey:"help.chat.followup.addresses_default",label:"How do I set a default?"}],match:u=>/address|addresses|multiple locations|warehouse|branch|default|saved/i.test(u),answerKey:"help.chat.answer.addresses",answer:()=>'Business customers can save multiple delivery addresses (Main Store, Warehouse, Branch) and set a default for faster checkout.<br><a href="./account.html#addresses">Manage addresses</a>'}],A={shipping_fees:"shipping",shipping_time:"shipping",sizes_shirts:"sizes",sizes_coats:"sizes",thickness_mil:"thickness",thickness_choice:"thickness",hangers_box:"hangers",hangers_choice:"hangers",hangers_caped:"hangers",usage_buffer:"usage",usage_quote:"usage",pay_invoice:"pay",pay_square:"pay",addresses_how:"addresses",addresses_default:"addresses"};let N=!1;function $(){return[{id:"sizes",label:d("help.chat.suggest.sizes","Choosing garment bag sizes")},{id:"thickness",label:d("help.chat.suggest.thickness","Heavy vs Extra Heavy thickness")},{id:"hangers",label:d("help.chat.suggest.hangers","Hangers: types + box quantity")},{id:"usage",label:d("help.chat.suggest.usage","How much packaging per month?")},{id:"shipping",label:d("help.chat.suggest.shipping","Shipping / delivery")},{id:"pay",label:d("help.chat.suggest.pay","Payments / pay later")}]}function T(u){if(!S)return;const w=Array.isArray(u)&&u.length?u:$();S.innerHTML=w.map(k=>`<button type="button" class="help-chip" data-help-chip="${B(k.id)}">${B(k.label)}</button>`).join("")}function O(u,w){if(!u||!w)return 0;let k=0;const v=Array.isArray(u.keywords)?u.keywords:[];for(const E of v){const q=f(E);q&&w.includes(q)&&(k+=q.length>=6?3:2)}return typeof u.match=="function"&&u.match(w)&&(k+=3),k}function G(u,w=3){const k=f(u);return b.map(v=>({f:v,score:O(v,k)})).sort((v,E)=>E.score-v.score).filter(v=>v.score>0).slice(0,w).map(v=>v.f)}function D(){if(!h)return null;const u=document.createElement("div");u.className="help-chat-msg bot";const w=document.createElement("div");return w.className="help-chat-bubble",w.textContent="...",u.appendChild(w),h.appendChild(u),h.scrollTop=h.scrollHeight,u}function F(u){T(u),!(N||!S)&&(N=!0,S.addEventListener("click",w=>{const k=w.target?.closest?.("[data-help-chip]");if(!k)return;const v=String(k.getAttribute("data-help-chip")||"").trim(),E=String(k.textContent||"").trim();if(!v)return;const q=A[v]||v,z=b.find(R=>R.id===q)||null;if(z){c({role:"user",text:E||y(z)||v});const R=D();setTimeout(()=>{try{R?.remove?.()}catch{}c({role:"bot",html:x(z)});const K=Array.isArray(z.followups)?z.followups:[];K.length?F(K.map(V=>({id:V.id,label:d(V.labelKey,V.label)}))):F()},150);try{M?.focus?.()}catch{}return}j(E||v);try{M?.focus?.()}catch{}}))}function j(u){const w=String(u||"").trim();if(!w)return;if(c({role:"user",text:w}),H){m(w).then(q=>{if(q)return;const z=D();setTimeout(()=>{try{z?.remove?.()}catch{}},200),c({role:"bot",html:d("help.chat.fallback_html",'I can help with shipping, bag sizes, thickness, payments, and monthly usage. Try a quick button below, or visit <a href="./resources.html">Resources</a>.')}),F()});return}const k=D(),v=G(w,3),E=v[0]||null;setTimeout(()=>{try{k?.remove?.()}catch{}if(E){c({role:"bot",html:x(E)});const q=Array.isArray(E.followups)?E.followups:[];q.length?F(q.map(z=>({id:z.id,label:d(z.labelKey,z.label)}))):F();return}c({role:"bot",html:d("help.chat.fallback_html",'I can help with shipping, bag sizes, thickness, payments, and monthly usage. Try a quick button below, or visit <a href="./resources.html">Resources</a>.')}),v.length?F(v.map(q=>({id:q.id,label:y(q)}))):F()},250)}function Q(){!h||h.childElementCount||(c({role:"bot",html:d("help.chat.greeting_html","Hi! Ask me about shipping, garment bag sizes, thickness, or monthly packaging planning.")}),F())}C&&C.addEventListener("submit",u=>{u.preventDefault();const w=String(M?.value||"").trim();if(w){M&&(M.value=""),j(w);try{M?.focus?.()}catch{}}}),a&&a.addEventListener("click",()=>{i?.classList.contains("open")&&(Q(),M&&setTimeout(()=>M.focus(),0))}),r&&r.addEventListener("submit",async u=>{u.preventDefault();const w=String(r.name.value||"").trim(),k=String(r.email.value||"").trim(),v=String(r.message.value||"").trim();if(!w||!k||!v)return;const E=window.PPS_I18N?.getLang?.()||"en",q=n(E),z=q?.sending||window.PPS_I18N?.t("help.sending")||"Sending...",R=q?.sent||window.PPS_I18N?.t("help.sent")||"Thanks! We'll be in touch.",K=q?.error||window.PPS_I18N?.t("help.error")||"Unable to send right now. Please try again.";o&&(o.textContent=z);const V=r.querySelector("button[type='submit']");V&&(V.disabled=!0);try{const W=window.PPS?.API_BASE||window.PPS_API_BASE||"",U=await fetch(`${W}/api/help`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:w,email:k,message:v})}),Z=await U.json().catch(()=>({}));if(!U.ok||!Z.ok)throw new Error(Z?.message||"Failed");o&&(o.textContent=R),r.reset()}catch{o&&(o.textContent=K)}finally{V&&(V.disabled=!1)}}),window.addEventListener("pps:lang",s)}function setupRetentionSignals(){const e="pps_cart_last_update";window.addEventListener("pps:cart",r=>{try{localStorage.setItem(e,String(Date.now()))}catch{}});const a="pps_last_visit",i=Number(localStorage.getItem(a)||0),g=i?(Date.now()-i)/(1e3*60*60*24):0;if(localStorage.setItem(a,String(Date.now())),g>30&&!localStorage.getItem("pps_winback_shown")){localStorage.setItem("pps_winback_shown","true");const r=document.createElement("div");r.className="marketing-banner winback",r.innerHTML=`
      <div class="marketing-banner-inner">
        <strong>Welcome back!</strong>
        <span>Enjoy a win-back discount on your next bulk order.</span>
        <a class="btn btn-primary btn-sm" href="./specials.html">Claim offer</a>
        <button class="marketing-banner-close" type="button" aria-label="Close">x</button>
      </div>
    `,document.body.appendChild(r),r.querySelector(".marketing-banner-close")?.addEventListener("click",()=>r.remove())}}function showAuthModal(e={}){if(document.getElementById("ppsAuthModal"))return;if(window.PPS?.getSession?.()){window.location.href="./account.html";return}const s=String(e?.nextUrl||"").trim();if(s)try{sessionStorage.setItem("pps_login_next",s)}catch{}const a=document.createElement("div");a.className="pps-modal-overlay open",a.id="ppsAuthModal",a.innerHTML=`
    <div class="pps-modal pps-auth-modal" role="dialog" aria-modal="true" aria-labelledby="ppsAuthTitle">
      <button class="pps-auth-close-x" type="button" aria-label="Close">\xD7</button>
      <div class="pps-auth-layout">
        <div class="pps-auth-left" aria-hidden="true">
          <div class="pps-auth-brand">
            <img src="./assets/poly%20logo%20without%20background.png" alt="Power Poly Supplies" decoding="async">
            <div>PowerPolySupplies.com</div>
          </div>
           <div class="pps-auth-kicker">Canada-wide B2B sourcing</div>
           <h3 class="pps-auth-headline">Order protection and great savings.</h3>
           <div class="pps-auth-subline">Sign in to reorder faster, save multiple delivery addresses, and manage invoices.</div>
           <svg class="pps-auth-illustration pps-van" viewBox="0 0 240 140" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
             <defs>
               <linearGradient id="ppsAuthVanBody" x1="0" y1="0" x2="1" y2="1">
                 <stop offset="0" stop-color="#fff7ed"/>
                 <stop offset="1" stop-color="#ffffff"/>
               </linearGradient>
               <linearGradient id="ppsAuthVanAccent" x1="0" y1="0" x2="1" y2="0">
                 <stop offset="0" stop-color="#ff7a1a"/>
                 <stop offset="1" stop-color="#d94a1f"/>
               </linearGradient>
             </defs>

              <g class="cart-van-bg" aria-hidden="true">
                <g class="cart-van-bg-track">
                  <g opacity=".92">
                    <g opacity=".55">
                      <path d="M6 76V46h22v30H6Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M36 76V34h34v42H36Z" fill="rgba(17,24,39,.04)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M78 76V42h26v34H78Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M112 76V28h30v48h-30Z" fill="rgba(17,24,39,.04)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M150 76V40h28v36h-28Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                    </g>
                    <g opacity=".95">
                      <path d="M18 76V44c0-5 4-9 9-9h12c5 0 9 4 9 9v32H18Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.09)" stroke-width="2"/>
                      <path d="M62 76V30c0-6 5-11 11-11h18c6 0 11 5 11 11v46H62Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                      <path d="M118 76V36c0-6 5-11 11-11h12c6 0 11 5 11 11v40h-34Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.09)" stroke-width="2"/>
                      <path d="M156 76V26c0-6 5-11 11-11h22c6 0 11 5 11 11v50h-44Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                      <g fill="rgba(240,127,41,.13)">
                        <rect x="26" y="44" width="8" height="8" rx="2"/>
                        <rect x="38" y="44" width="8" height="8" rx="2"/>
                        <rect x="74" y="36" width="9" height="9" rx="2"/>
                        <rect x="88" y="36" width="9" height="9" rx="2"/>
                        <rect x="74" y="50" width="9" height="9" rx="2"/>
                        <rect x="88" y="50" width="9" height="9" rx="2"/>
                        <rect x="128" y="42" width="8" height="8" rx="2"/>
                        <rect x="138" y="42" width="8" height="8" rx="2"/>
                        <rect x="170" y="34" width="10" height="10" rx="2"/>
                        <rect x="184" y="34" width="10" height="10" rx="2"/>
                        <rect x="170" y="48" width="10" height="10" rx="2"/>
                        <rect x="184" y="48" width="10" height="10" rx="2"/>
                      </g>
                    </g>
                    <g class="cart-van-cn" transform="translate(196 8)" opacity=".98">
                      <path d="M8 0v8" stroke="rgba(17,24,39,.18)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M8 8V64" stroke="rgba(17,24,39,.12)" stroke-width="6" stroke-linecap="round"/>
                      <ellipse cx="8" cy="26" rx="13" ry="6.5" fill="rgba(255,255,255,.70)" stroke="rgba(240,127,41,.22)" stroke-width="2"/>
                      <ellipse cx="8" cy="26" rx="4.5" ry="3.5" fill="rgba(17,24,39,.06)"/>
                      <path d="M8 64l-6 8h12l-6-8Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                    </g>
                    <g opacity=".9">
                      <path d="M0 86c26-10 54-12 84-6 22-10 48-10 78 0 18-7 42-7 78 0v12H0V86Z" fill="rgba(240,127,41,.10)"/>
                      <path d="M18 28c3-8 10-12 18-10 3-6 12-8 18-4 7-2 14 3 14 11 0 7-6 12-14 12H34c-10 0-18-5-16-9Z" fill="rgba(255,255,255,.55)"/>
                      <path d="M146 24c2-6 8-9 14-8 2-5 9-7 14-4 6-1 11 3 11 9 0 6-5 10-11 10h-31c-8 0-15-4-13-7Z" fill="rgba(255,255,255,.50)"/>
                    </g>
                  </g>
                  <g opacity=".92" transform="translate(240 0)">
                    <g opacity=".55">
                      <path d="M6 76V46h22v30H6Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M36 76V34h34v42H36Z" fill="rgba(17,24,39,.04)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M78 76V42h26v34H78Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M112 76V28h30v48h-30Z" fill="rgba(17,24,39,.04)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                      <path d="M150 76V40h28v36h-28Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.06)" stroke-width="2"/>
                    </g>
                    <g opacity=".95">
                      <path d="M18 76V44c0-5 4-9 9-9h12c5 0 9 4 9 9v32H18Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.09)" stroke-width="2"/>
                      <path d="M62 76V30c0-6 5-11 11-11h18c6 0 11 5 11 11v46H62Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                      <path d="M118 76V36c0-6 5-11 11-11h12c6 0 11 5 11 11v40h-34Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.09)" stroke-width="2"/>
                      <path d="M156 76V26c0-6 5-11 11-11h22c6 0 11 5 11 11v50h-44Z" fill="rgba(17,24,39,.05)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                      <g fill="rgba(240,127,41,.13)">
                        <rect x="26" y="44" width="8" height="8" rx="2"/>
                        <rect x="38" y="44" width="8" height="8" rx="2"/>
                        <rect x="74" y="36" width="9" height="9" rx="2"/>
                        <rect x="88" y="36" width="9" height="9" rx="2"/>
                        <rect x="74" y="50" width="9" height="9" rx="2"/>
                        <rect x="88" y="50" width="9" height="9" rx="2"/>
                        <rect x="128" y="42" width="8" height="8" rx="2"/>
                        <rect x="138" y="42" width="8" height="8" rx="2"/>
                        <rect x="170" y="34" width="10" height="10" rx="2"/>
                        <rect x="184" y="34" width="10" height="10" rx="2"/>
                        <rect x="170" y="48" width="10" height="10" rx="2"/>
                        <rect x="184" y="48" width="10" height="10" rx="2"/>
                      </g>
                    </g>
                    <g class="cart-van-cn" transform="translate(196 8)" opacity=".98">
                      <path d="M8 0v8" stroke="rgba(17,24,39,.18)" stroke-width="2" stroke-linecap="round"/>
                      <path d="M8 8V64" stroke="rgba(17,24,39,.12)" stroke-width="6" stroke-linecap="round"/>
                      <ellipse cx="8" cy="26" rx="13" ry="6.5" fill="rgba(255,255,255,.70)" stroke="rgba(240,127,41,.22)" stroke-width="2"/>
                      <ellipse cx="8" cy="26" rx="4.5" ry="3.5" fill="rgba(17,24,39,.06)"/>
                      <path d="M8 64l-6 8h12l-6-8Z" fill="rgba(17,24,39,.06)" stroke="rgba(17,24,39,.08)" stroke-width="2"/>
                    </g>
                    <g opacity=".9">
                      <path d="M0 86c26-10 54-12 84-6 22-10 48-10 78 0 18-7 42-7 78 0v12H0V86Z" fill="rgba(240,127,41,.10)"/>
                      <path d="M18 28c3-8 10-12 18-10 3-6 12-8 18-4 7-2 14 3 14 11 0 7-6 12-14 12H34c-10 0-18-5-16-9Z" fill="rgba(255,255,255,.55)"/>
                      <path d="M146 24c2-6 8-9 14-8 2-5 9-7 14-4 6-1 11 3 11 9 0 6-5 10-11 10h-31c-8 0-15-4-13-7Z" fill="rgba(255,255,255,.50)"/>
                    </g>
                  </g>
                </g>
                <path d="M0 126H240" stroke="rgba(17,24,39,.10)" stroke-width="10" stroke-linecap="round" opacity=".55"/>
                <ellipse cx="80" cy="126" rx="22" ry="7" fill="rgba(17,24,39,.06)"/>
                <ellipse cx="170" cy="126" rx="22" ry="7" fill="rgba(17,24,39,.06)"/>
               <g class="cart-van-road" aria-hidden="true">
                 <g class="cart-van-road-track">
                   <path d="M10 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                   <path d="M66 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                   <path d="M122 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                   <path d="M178 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                   <g transform="translate(240 0)">
                     <path d="M10 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                     <path d="M66 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                     <path d="M122 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                     <path d="M178 126h42" stroke="rgba(255,255,255,.65)" stroke-width="4" stroke-linecap="round"/>
                   </g>
                 </g>
               </g>
             </g>

             <g class="cart-van-float">
               <path class="cart-van-shadow" d="M32 122c22 8 154 8 176 0" fill="none" stroke="rgba(17,24,39,.10)" stroke-width="10" stroke-linecap="round"/>
 
                <g class="cart-van-lines" fill="none" stroke-linecap="round">
                  <path d="M18 76h22" stroke="rgba(17,24,39,.18)" stroke-width="4"/>
                  <path d="M10 92h30" stroke="rgba(17,24,39,.12)" stroke-width="4"/>
                  <path d="M22 108h18" stroke="rgba(17,24,39,.10)" stroke-width="4"/>
                </g>

               <path d="M58 48h92c12 0 22 8 28 18l14 26c4 8 2 18-6 24-8 6-18 10-30 10H70c-16 0-28-12-28-28V74c0-14 2-26 16-26Z"
                 fill="url(#ppsAuthVanBody)" stroke="rgba(17,24,39,.14)" stroke-width="2.5" />

               <path d="M150 48h22c10 0 20 7 25 16l10 20c4 8 2 18-6 24-7 5-16 8-26 8h-30V60c0-6 4-12 5-12Z"
                 fill="url(#ppsAuthVanBody)" stroke="rgba(17,24,39,.14)" stroke-width="2.5" />

                 <path d="M165 58h20c6 0 11 4 13 10l4 10c1 3-1 6-4 6h-36V58Z"
                   fill="rgba(37,99,235,.10)" stroke="rgba(37,99,235,.20)" stroke-width="2" />

                 <path d="M160 70h6l3 6h-7l-2-6Z"
                   fill="rgba(17,24,39,.10)" stroke="rgba(17,24,39,.16)" stroke-width="1.6" />

                <path d="M68 56h70" stroke="rgba(255,255,255,.92)" stroke-width="4" stroke-linecap="round" opacity=".22"/>
                <path d="M156 56h26" stroke="rgba(255,255,255,.92)" stroke-width="4" stroke-linecap="round" opacity=".18"/>

                <path d="M124 56v46" stroke="rgba(17,24,39,.10)" stroke-width="2" stroke-linecap="round"/>
                <path d="M132 74h10" stroke="rgba(17,24,39,.18)" stroke-width="2" stroke-linecap="round"/>

                 <g class="pps-van-sticker" transform="translate(92 58)" style="filter: drop-shadow(0 10px 16px rgba(17,24,39,.14));">
                   <rect x="0" y="0" width="30" height="30" rx="9" fill="rgba(255,255,255,.92)" stroke="rgba(240,127,41,.45)" stroke-width="1.8"/>
                   <image href="./assets/poly%20logo%20without%20background.png" x="5" y="5" width="20" height="20" preserveAspectRatio="xMidYMid meet"/>
                 </g>

                <circle cx="200" cy="92" r="9" fill="rgba(255,214,120,.20)"/>
                <circle cx="200" cy="92" r="3.4" fill="rgba(255,214,120,.96)" stroke="rgba(240,127,41,.35)" stroke-width="1"/>
 
                <path d="M58 86h156" stroke="url(#ppsAuthVanAccent)" stroke-width="8" stroke-linecap="round" opacity=".9"/>

               <g class="cart-van-wheel cart-van-wheel-left" transform="translate(80 112)">
                 <g class="cart-van-wheel-spin">
                   <circle r="14" fill="#111827" opacity=".86"/>
                   <circle r="7" fill="rgba(255,255,255,.92)"/>
                   <path d="M0-10V10M-10 0H10M-7-7l14 14M-7 7l14-14" stroke="rgba(17,24,39,.35)" stroke-width="2" stroke-linecap="round"/>
                 </g>
               </g>
               <g class="cart-van-wheel cart-van-wheel-right" transform="translate(170 112)">
                 <g class="cart-van-wheel-spin">
                   <circle r="14" fill="#111827" opacity=".86"/>
                   <circle r="7" fill="rgba(255,255,255,.92)"/>
                   <path d="M0-10V10M-10 0H10M-7-7l14 14M-7 7l14-14" stroke="rgba(17,24,39,.35)" stroke-width="2" stroke-linecap="round"/>
                 </g>
               </g>

              </g>
            </svg>
          </div>
 
         <div class="pps-auth-right">
           <h2 id="ppsAuthTitle">Sign in or create account</h2>

          <button class="pps-auth-provider" type="button" data-auth-provider="google" disabled>
            <span class="pps-auth-icon google-icon" aria-hidden="true"></span>
            Continue with Google
          </button>
          <button class="pps-auth-provider" type="button" data-auth-provider="facebook" disabled style="margin-top:10px;">
            <span class="pps-auth-icon facebook-icon" aria-hidden="true"></span>
            Continue with Facebook
          </button>

          <div class="pps-auth-divider">OR</div>

          <form class="pps-auth-form" id="ppsAuthForm">
            <input class="input" type="email" name="email" placeholder="Enter your email address" autocomplete="email" required>
            <div class="password-field">
              <input class="input" type="password" name="password" id="ppsAuthPassword" placeholder="Password" autocomplete="current-password" required>
              <button class="toggle-visibility hidden" type="button" aria-label="Show password" title="Show password" data-toggle="ppsAuthPassword">
                <span class="eye"></span>
              </button>
            </div>
            <button class="btn btn-primary" type="submit" id="ppsAuthContinue">Continue</button>
            <div id="ppsAuthStatus" class="status muted" style="display:none;"></div>
          </form>

          <div class="pps-auth-footer">
            <div class="pps-auth-mini">New here? <a href="./signup.html">Create an account</a></div>
            <div class="pps-auth-mini"><a href="./contact.html">Need help?</a></div>
          </div>

          <div class="pps-auth-mini" style="margin-top:10px;">
            Social sign-in is enabled when OAuth is configured on the backend.
          </div>
        </div>
      </div>
    </div>
  `,document.body.appendChild(a);const i=a.querySelector(".pps-modal"),g=a.querySelector(".pps-auth-close-x"),r=a.querySelector("#ppsAuthStatus"),o=a.querySelector("#ppsAuthForm"),l=a.querySelector(".toggle-visibility"),p=a.querySelector('[data-auth-provider="google"]'),h=a.querySelector('[data-auth-provider="facebook"]'),S=(c,d="muted")=>{if(!r)return;const y=String(c||"").trim();if(!y){r.style.display="none",r.textContent="";return}r.style.display="block",r.classList.remove("error","success","muted"),r.classList.add("status",d||"muted"),r.textContent=y},C=()=>{try{document.removeEventListener("keydown",P)}catch{}a.classList.remove("open"),setTimeout(()=>a.remove(),160)},M=c=>{const d=String(c||"");return d?d.includes("Supabase not configured")?window.PPS_I18N?.t("login.status.unavailable")||"Login temporarily unavailable. Please try again later.":d:""},I=async(c,d)=>{const y=window.PPS?.API_BASE||"";if(!y){S("Backend API not configured.","error");return}S(window.PPS_I18N?.t("login.status.signing")||"Signing in...","muted");const x=a.querySelector("#ppsAuthContinue");x&&(x.disabled=!0);try{const b=await fetch(`${y}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c,password:d})}),A=await b.json().catch(()=>({}));if(b.ok&&A.ok&&A.token){const N=String(A.email||c).trim().toLowerCase();let $={};try{$=JSON.parse(localStorage.getItem(`pps_profile_${N}`)||"{}")}catch{$={}}window.PPS?.setSession?.({token:A.token,email:N,name:A.name||"",phone:String($?.phone||""),province:String($?.province||""),expiresAt:A.expiresAt});try{window.PPS_ACTIVITY?.record?.("login",{email:N})}catch{}let T="";try{T=String(sessionStorage.getItem("pps_login_next")||"").trim()}catch{T=""}try{sessionStorage.removeItem("pps_login_next")}catch{}const O=T&&!/\/login\.html(\?|#|$)/i.test(T)?T:"";window.location.href=O||"./account.html"}else{const N=M(A?.message);S(N||window.PPS_I18N?.t("login.status.failed")||"Login failed.","error")}}catch{S(window.PPS_I18N?.t("login.status.unreachable")||"Server unreachable. Is the backend running?","error")}finally{x&&(x.disabled=!1)}},H=c=>{const d=window.PPS?.API_BASE||"";if(!d){S("Backend API not configured.","error");return}const y=(()=>{try{return String(sessionStorage.getItem("pps_login_next")||"").trim()||window.location.href}catch{return window.location.href}})(),x=`${d}/api/auth/oauth/${encodeURIComponent(c)}/start?next=${encodeURIComponent(y)}`;window.location.href=x},L=async()=>{const c=window.PPS?.API_BASE||"";if(c)try{const y=await(await fetch(`${c}/api/auth/oauth/status`,{cache:"no-store"})).json().catch(()=>({})),x=!!y?.providers?.google?.configured,b=!!y?.providers?.facebook?.configured;p&&(p.disabled=!x),h&&(h.disabled=!b)}catch{p&&(p.disabled=!0),h&&(h.disabled=!0)}},m=(c,d)=>{const y=window.PPS_I18N?.t("signup.password.show")||"Show password",x=window.PPS_I18N?.t("signup.password.hide")||"Hide password",b=d==="password"?y:x;c.setAttribute("aria-label",b),c.setAttribute("title",b)};l&&(m(l,"password"),l.addEventListener("click",c=>{const d=c.currentTarget,y=d.dataset.toggle,x=document.getElementById(y);if(!x)return;const b=x.type==="password"?"text":"password";x.type=b,m(d,b),d.classList.toggle("visible",b==="text"),d.classList.toggle("hidden",b==="password")})),g&&g.addEventListener("click",C),a.addEventListener("click",c=>{c.target===a&&C()});function P(c){c.key==="Escape"&&C()}document.addEventListener("keydown",P),o&&o.addEventListener("submit",c=>{c.preventDefault();const d=String(o.email?.value||"").trim(),y=String(o.password?.value||"");if(!d||!y){S(window.PPS_I18N?.t("login.status.missing")||"Enter email and password.","error");return}I(d,y)}),p&&p.addEventListener("click",()=>H("google")),h&&h.addEventListener("click",()=>H("facebook")),L();const _=a.querySelector('input[name="email"]');_&&setTimeout(()=>_.focus(),0),document.documentElement.style.overflow="hidden";const B=()=>{document.documentElement.style.overflow=""},f=new MutationObserver(()=>{document.getElementById("ppsAuthModal")||(f.disconnect(),B())});f.observe(document.body,{childList:!0})}function handleOauthReturn(){let e=null;try{e=new URLSearchParams(window.location.search)}catch{return}if(!e)return;const t=String(e.get("pps_oauth")||"").trim(),n=String(e.get("token")||"").trim();if(t!=="1"||!n)return;const s=String(e.get("ok")||"").trim(),a=String(e.get("message")||"").trim(),i=String(e.get("email")||"").trim().toLowerCase(),g=String(e.get("name")||"").trim(),r=Number(e.get("expiresAt")||0)||0,o=String(e.get("next")||"").trim();try{const p=new URL(window.location.href);["pps_oauth","provider","ok","token","email","name","expiresAt","message","next"].forEach(h=>p.searchParams.delete(h)),window.history.replaceState({},"",p.toString())}catch{}if(s!=="1"){try{a&&sessionStorage.setItem("pps_login_error",a)}catch{}/\/login\.html(\?|#|$)/i.test(String(window.location.pathname||""))||(window.location.href="./login.html");return}try{window.PPS?.setSession?.({token:n,email:i,name:g,phone:"",province:"",expiresAt:r||Date.now()+10080*60*1e3})}catch{}const l=(()=>{if(!o)return"";if(o.startsWith("/")&&!o.startsWith("//"))return o;try{const p=new URL(o,window.location.origin);return p.origin!==window.location.origin?"":p.pathname+p.search+p.hash}catch{return""}})();window.location.href=l||"./account.html"}function setupAuthModalTriggers(){const e=document.querySelector('a[href="./login.html"]');e&&e.addEventListener("click",t=>{window.PPS?.getSession?.()||(t.preventDefault(),showAuthModal({nextUrl:"./account.html"}))});try{String(window.location.pathname||"").toLowerCase().endsWith("/login.html")&&(window.PPS?.getSession?.()||showAuthModal({nextUrl:"./account.html"}))}catch{}}function setupTopProgressBar(){const e=document.getElementById("ppsTopProgress");if(e)return e;const t=document.createElement("div");return t.className="pps-top-progress",t.id="ppsTopProgress",t.setAttribute("aria-hidden","true"),t.innerHTML='<div class="pps-top-progress__bar"></div>',document.body.insertAdjacentElement("afterbegin",t),t}function createTopProgressController(){const e=setupTopProgressBar(),t=e.querySelector(".pps-top-progress__bar");if(!t)return null;let n=0,s=0,a=0,i=0;const g=I=>Math.max(0,Math.min(1,I)),r=()=>{t.style.transform=`scaleX(${s.toFixed(4)})`},o=()=>{n&&(cancelAnimationFrame(n),n=0)},l=()=>{const I=(a-s)*.16+.0025;s=g(s+Math.max(0,I)),r(),s+.002<a?n=requestAnimationFrame(l):o()},p=()=>{clearTimeout(i),e.classList.add("active")},h=()=>{e.classList.remove("active")};return{start:(I=.08)=>{p(),s=Math.max(s,g(I)),a=Math.max(a,.82),r(),n||(n=requestAnimationFrame(l))},set:I=>{p(),s=g(I),a=Math.max(a,s),r()},done:()=>{p(),o(),s=1,a=1,r(),clearTimeout(i),i=setTimeout(()=>{h(),setTimeout(()=>{s=0,a=0,r()},170)},160)}}}function setupPageTransitionProgress(){const e=createTopProgressController();if(!e)return;const t="pps_nav_progress",n=()=>{try{sessionStorage.setItem(t,String(Date.now()))}catch{}};(()=>{try{const i=sessionStorage.getItem(t);if(!i)return!1;sessionStorage.removeItem(t);const g=Number(i)||0;return g>0&&Date.now()-g<1e4}catch{return!1}})()&&e.start(.14),document.addEventListener("click",i=>{if(i.defaultPrevented||i.button!==0||i.metaKey||i.ctrlKey||i.shiftKey||i.altKey)return;const g=i.target;if(!(g instanceof Node))return;const r=g.closest?.("a");if(!r||r.hasAttribute("download"))return;const o=String(r.getAttribute("href")||"").trim();if(!o||o.startsWith("#")||/^mailto:/i.test(o)||/^tel:/i.test(o)||/^javascript:/i.test(o))return;const l=String(r.getAttribute("target")||"").trim();if(l&&l!=="_self")return;let p=null;try{p=new URL(o,window.location.href)}catch{return}!p||p.origin!==window.location.origin||p.pathname===window.location.pathname&&p.search===window.location.search&&p.hash||(e.start(.08),n())},!0),document.addEventListener("submit",i=>{if(i.defaultPrevented)return;const g=i.target;if(!(g instanceof HTMLFormElement))return;const r=String(g.getAttribute("action")||window.location.href).trim();if(!r||/^javascript:/i.test(r))return;let o=null;try{o=new URL(r,window.location.href)}catch{return}o.origin===window.location.origin&&(e.start(.08),n())},!0);const a=()=>e.done();window.addEventListener("load",a),window.addEventListener("pageshow",i=>{i&&i.persisted&&a()}),document.readyState==="complete"&&setTimeout(a,0)}handleOauthReturn(),setupPageTransitionProgress(),window.addEventListener("DOMContentLoaded",()=>{try{"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"./"}).catch(()=>{})}catch{}try{if(!document.querySelector('link[rel="manifest"]')){const e=document.createElement("link");e.rel="manifest",e.href="./manifest.webmanifest",document.head.appendChild(e)}if(!document.querySelector('meta[name="theme-color"]')){const e=document.createElement("meta");e.name="theme-color",e.content="#ff7a1a",document.head.appendChild(e)}}catch{}decoratePromoTagline(),setupNavbar(),setupFadeIn(),setupStickyHeader(),setupAnalytics(),setupJourneyTracking(),setupImageOptimization(),syncAccountLink(),setupAuthModalTriggers(),injectResourcesDropdown(),injectAboutDropdown(),injectLangSwitcher(),injectCurrencySwitcher(),injectNotificationsBell(),injectMiniCartPreview(),injectCartSidebar(),setupSearch(),setupCountUp(),injectBottomNav(),setupBottomNavSearch(),setupInteractiveTools(),injectFooter(),injectHelpWidget(),setupRetentionSignals(),scheduleLanguagePrompt()}),window.injectFooter=injectFooter;
(function(){const s=["[data-vercel-toolbar]","[data-vercel-speed-insights]","[data-vercel]","#vercel-toolbar","#__vercel","#vercel-live-feedback",'iframe[src*="/_vercel/"]','iframe[src*="vercel.live"]','iframe[src*="vercel.com"]','iframe[title*="Vercel"]'];const r=()=>{try{s.forEach(q=>document.querySelectorAll(q).forEach(el=>{try{el.remove()}catch(_){if(el&&el.style){el.style.display="none";el.style.visibility="hidden";el.style.pointerEvents="none"}}}))}catch(_){}};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",()=>{r();setTimeout(r,250);setTimeout(r,1e3)},{once:true})}else{r();setTimeout(r,250);setTimeout(r,1e3)}if(typeof MutationObserver!=="undefined"){try{new MutationObserver(r).observe(document.documentElement||document.body,{childList:true,subtree:true})}catch(_){}}})();


